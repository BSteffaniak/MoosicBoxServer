import{d as Q,c as H,h as K,j as V,e as C,o as j,g as $,a,i as n,b,f as M,k as q,F as L,t as g,S as k,r as Y}from"./web.o2PnP_jd.js";import{d as G,a as J,b as D,c as U,e as W}from"./Album.B7ZnFso0.js";import{a as X}from"./api.DZqBGp_p.js";import{d as I}from"./ChangePlaybackTargetModal.BU1Vz2Zf.js";/* empty css                        */var Z=g("<div class=downloads-download-task-progress-details><!$><!/><!$><!/>%<!$><!/>"),ee=g("<div class=downloads-download-task-progress-bar><div class=downloads-download-task-progress-bar-progress></div><div class=downloads-download-task-progress-bar-progress-trigger>"),P=g("<div class=downloads-download-task-cover>"),te=g("<button>Retry"),le=g("<div class=downloads-download-task-details><div class=downloads-download-task-header-details>Track (<!$><!/>) - <!$><!/> - <!$><!/> - <!$><!/><!$><!/></div><div class=downloads-download-task-location-details></div><div class=downloads-download-task-progress>"),ne=g("<div class=downloads-download-task-details><div class=downloads-download-task-header-details>Album (<!$><!/>) cover - <!$><!/> - <!$><!/></div><div class=downloads-download-task-location-details></div><div class=downloads-download-task-progress>"),ie=g("<div class=downloads-download-task-details><div class=downloads-download-task-header-details>Artist (<!$><!/>) (album_id: <!$><!/>) cover - <!$><!/> - <!$><!/></div><div class=downloads-download-task-location-details></div><div class=downloads-download-task-progress>"),ae=g("<div class=downloads-download-tasks>No <!$><!/> tasks"),se=g("<div class=downloads-download-tasks>"),oe=g("<div>");function B(e){return[(()=>{var o=$(Z),i=o.firstChild,[_,t]=a(i.nextSibling),l=_.nextSibling,[s,c]=a(l.nextSibling),r=s.nextSibling,w=r.nextSibling,[u,S]=a(w.nextSibling);return n(o,(()=>{var d=C(()=>typeof e.bytes=="number"&&typeof e.totalBytes=="number");return()=>d()?`${(e.bytes/1024/1024).toFixed(2)}/${(e.totalBytes/1024/1024).toFixed(2)} MiB - `:""})(),_,t),n(o,()=>~~e.progress,s,c),n(o,(()=>{var d=C(()=>!!e.speed);return()=>d()?` - ${(e.speed/1024).toFixed(2)} KiB/s`:""})(),u,S),o})(),(()=>{var o=$(ee),i=o.firstChild;return M(_=>(_=`${e.progress}%`)!=null?i.style.setProperty("width",_):i.style.removeProperty("width")),o})()]}function re(e){const o=e.id,i=e.item,_=i.type;switch(_){case"TRACK":return[(()=>{var t=$(P);return n(t,b(U,{get album(){return{...e.item,type:i.source}},size:80})),t})(),(()=>{var t=$(le),l=t.firstChild,s=l.firstChild,c=s.nextSibling,[r,w]=a(c.nextSibling),u=r.nextSibling,S=u.nextSibling,[d,p]=a(S.nextSibling),m=d.nextSibling,h=m.nextSibling,[x,f]=a(h.nextSibling),v=x.nextSibling,y=v.nextSibling,[T,R]=a(y.nextSibling),E=T.nextSibling,[A,O]=a(E.nextSibling),F=l.nextSibling,z=F.nextSibling;return n(l,()=>i.trackId,r,w),n(l,()=>i.title,d,p),n(l,()=>D(e.state),x,f),n(l,()=>W(i.source),T,R),n(l,b(k,{get when(){return e.state==="ERROR"},get children(){var N=$(te);return N.$$click=()=>X.retryDownload(o),Y(),N}}),A,O),n(F,()=>e.filePath),n(z,b(k,{get when(){return e.state==="STARTED"},get children(){return B(e)}})),t})()];case"ALBUM_COVER":return[(()=>{var t=$(P);return n(t,b(U,{get album(){return{...e.item,type:i.source}},size:80})),t})(),(()=>{var t=$(ne),l=t.firstChild,s=l.firstChild,c=s.nextSibling,[r,w]=a(c.nextSibling),u=r.nextSibling,S=u.nextSibling,[d,p]=a(S.nextSibling),m=d.nextSibling,h=m.nextSibling,[x,f]=a(h.nextSibling),v=l.nextSibling,y=v.nextSibling;return n(l,()=>i.albumId,r,w),n(l,()=>i.title,d,p),n(l,()=>D(e.state),x,f),n(v,()=>e.filePath),n(y,b(k,{get when(){return e.state==="STARTED"},get children(){return B(e)}})),t})()];case"ARTIST_COVER":return[(()=>{var t=$(P);return n(t,b(J,{get artist(){return{...e.item,type:i.source}},size:80})),t})(),(()=>{var t=$(ie),l=t.firstChild,s=l.firstChild,c=s.nextSibling,[r,w]=a(c.nextSibling),u=r.nextSibling,S=u.nextSibling,[d,p]=a(S.nextSibling),m=d.nextSibling,h=m.nextSibling,[x,f]=a(h.nextSibling),v=x.nextSibling,y=v.nextSibling,[T,R]=a(y.nextSibling),E=l.nextSibling,A=E.nextSibling;return n(l,()=>i.artistId,r,w),n(l,()=>i.albumId,d,p),n(l,()=>i.title,x,f),n(l,()=>D(e.state),T,R),n(E,()=>e.filePath),n(A,b(k,{get when(){return e.state==="STARTED"},get children(){return B(e)}})),t})()];default:throw new Error(`Invalid taskType: '${_}'`)}}function be(e){const[o,i]=H([]);function _(){const t=e.state;switch(t){case"QUEUED":i(I.currentTasks);break;case"HISTORY":i(I.historyTasks);break;default:throw new Error(`Invalid DownloadQueueState '${t}'`)}}return K(_),V(j(()=>I.tasks,_)),C(()=>C(()=>o().length===0)()?(()=>{var t=$(ae),l=t.firstChild,s=l.nextSibling,[c,r]=a(s.nextSibling);return c.nextSibling,n(t,()=>e.state==="QUEUED"?"queued":"history",c,r),t})():(()=>{var t=$(se);return n(t,b(L,{get each(){return o()},children:l=>(()=>{var s=$(oe);return n(s,()=>re(l)),M(()=>q(s,`downloads-download-task ${G(l.state)}`)),s})()})),t})())}Q(["click"]);export{be as default};
//# sourceMappingURL=DownloadQueue.BrZpeogb.js.map
