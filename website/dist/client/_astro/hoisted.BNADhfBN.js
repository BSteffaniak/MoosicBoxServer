import{h as tt,T as rt,p as nt,U as Qt,e as Zt,q as Jt,V as zt,W as qe,f as Kt,u as er,A as it,I as Le,c as Ve,X as tr,Y as rr,Z as nr,_ as ir,J as sr,$ as or,F as ar}from"./ChangePlaybackTargetModal.BU1Vz2Zf.js";import{c as lr}from"./web.o2PnP_jd.js";import{r as cr,A as Y,a as ur,Q as dr,m as hr}from"./api.DZqBGp_p.js";/* empty css                        *//*!
Turbo 8.0.5
Copyright Â© 2024 37signals LLC
 */(function(i){if(typeof i.requestSubmit=="function")return;i.requestSubmit=function(n){n?(e(n,this),n.click()):(n=document.createElement("input"),n.type="submit",n.hidden=!0,this.appendChild(n),n.click(),this.removeChild(n))};function e(n,o){n instanceof HTMLElement||t(TypeError,"parameter 1 is not of type 'HTMLElement'"),n.type=="submit"||t(TypeError,"The specified element is not a submit button"),n.form==o||t(DOMException,"The specified element is not owned by this form element","NotFoundError")}function t(n,o,h){throw new n("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+o+".",h)}})(HTMLFormElement.prototype);const vt=new WeakMap;function fr(i){const e=i instanceof Element?i:i instanceof Node?i.parentElement:null,t=e?e.closest("input, button"):null;return t?.type=="submit"?t:null}function mr(i){const e=fr(i.target);e&&e.form&&vt.set(e.form,e)}(function(){if("submitter"in Event.prototype)return;let i=window.Event.prototype;if("SubmitEvent"in window){const e=window.SubmitEvent.prototype;if(/Apple Computer/.test(navigator.vendor)&&!("submitter"in e))i=e;else return}addEventListener("click",mr,!0),Object.defineProperty(i,"submitter",{get(){if(this.type=="submit"&&this.target instanceof HTMLFormElement)return vt.get(this.target)}})})();const se={eager:"eager",lazy:"lazy"};class V extends HTMLElement{static delegateConstructor=void 0;loaded=Promise.resolve();static get observedAttributes(){return["disabled","loading","src"]}constructor(){super(),this.delegate=new V.delegateConstructor(this)}connectedCallback(){this.delegate.connect()}disconnectedCallback(){this.delegate.disconnect()}reload(){return this.delegate.sourceURLReloaded()}attributeChangedCallback(e){e=="loading"?this.delegate.loadingStyleChanged():e=="src"?this.delegate.sourceURLChanged():e=="disabled"&&this.delegate.disabledChanged()}get src(){return this.getAttribute("src")}set src(e){e?this.setAttribute("src",e):this.removeAttribute("src")}get refresh(){return this.getAttribute("refresh")}set refresh(e){e?this.setAttribute("refresh",e):this.removeAttribute("refresh")}get loading(){return pr(this.getAttribute("loading")||"")}set loading(e){e?this.setAttribute("loading",e):this.removeAttribute("loading")}get disabled(){return this.hasAttribute("disabled")}set disabled(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get autoscroll(){return this.hasAttribute("autoscroll")}set autoscroll(e){e?this.setAttribute("autoscroll",""):this.removeAttribute("autoscroll")}get complete(){return!this.delegate.isLoading}get isActive(){return this.ownerDocument===document&&!this.isPreview}get isPreview(){return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")}}function pr(i){switch(i.toLowerCase()){case"lazy":return se.lazy;default:return se.eager}}function O(i){return new URL(i.toString(),document.baseURI)}function ee(i){let e;if(i.hash)return i.hash.slice(1);if(e=i.href.match(/#(.*)$/))return e[1]}function Ne(i,e){const t=e?.getAttribute("formaction")||i.getAttribute("action")||i.action;return O(t)}function gr(i){return(wr(i).match(/\.[^.]*$/)||[])[0]||""}function vr(i){return!!gr(i).match(/^(?:|\.(?:htm|html|xhtml|php))$/)}function br(i,e){const t=Sr(e);return i.href===O(t).href||i.href.startsWith(t)}function Q(i,e){return br(i,e)&&vr(i)}function Be(i){const e=ee(i);return e!=null?i.href.slice(0,-(e.length+1)):i.href}function Ee(i){return Be(i)}function _r(i,e){return O(i).href==O(e).href}function yr(i){return i.pathname.split("/").slice(1)}function wr(i){return yr(i).slice(-1)[0]}function Sr(i){return Ar(i.origin+i.pathname)}function Ar(i){return i.endsWith("/")?i:i+"/"}class We{constructor(e){this.response=e}get succeeded(){return this.response.ok}get failed(){return!this.succeeded}get clientError(){return this.statusCode>=400&&this.statusCode<=499}get serverError(){return this.statusCode>=500&&this.statusCode<=599}get redirected(){return this.response.redirected}get location(){return O(this.response.url)}get isHTML(){return this.contentType&&this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)}get statusCode(){return this.response.status}get contentType(){return this.header("Content-Type")}get responseText(){return this.response.clone().text()}get responseHTML(){return this.isHTML?this.response.clone().text():Promise.resolve(void 0)}header(e){return this.response.headers.get(e)}}function _e(i){if(i.getAttribute("data-turbo-eval")=="false")return i;{const e=document.createElement("script"),t=de("csp-nonce");return t&&(e.nonce=t),e.textContent=i.textContent,e.async=!1,Er(e,i),e}}function Er(i,e){for(const{name:t,value:n}of e.attributes)i.setAttribute(t,n)}function Tr(i){const e=document.createElement("template");return e.innerHTML=i,e.content}function I(i,{target:e,cancelable:t,detail:n}={}){const o=new CustomEvent(i,{cancelable:t,bubbles:!0,composed:!0,detail:n});return e&&e.isConnected?e.dispatchEvent(o):document.documentElement.dispatchEvent(o),o}function ae(){return document.visibilityState==="hidden"?_t():bt()}function bt(){return new Promise(i=>requestAnimationFrame(()=>i()))}function _t(){return new Promise(i=>setTimeout(()=>i(),0))}function Lr(){return Promise.resolve()}function yt(i=""){return new DOMParser().parseFromString(i,"text/html")}function wt(i,...e){const t=Rr(i,e).replace(/^\n/,"").split(`
`),n=t[0].match(/^\s+/),o=n?n[0].length:0;return t.map(h=>h.slice(o)).join(`
`)}function Rr(i,e){return i.reduce((t,n,o)=>{const h=e[o]==null?"":e[o];return t+n+h},"")}function Z(){return Array.from({length:36}).map((i,e)=>e==8||e==13||e==18||e==23?"-":e==14?"4":e==19?(Math.floor(Math.random()*4)+8).toString(16):Math.floor(Math.random()*15).toString(16)).join("")}function Re(i,...e){for(const t of e.map(n=>n?.getAttribute(i)))if(typeof t=="string")return t;return null}function kr(i,...e){return e.some(t=>t&&t.hasAttribute(i))}function ke(...i){for(const e of i)e.localName=="turbo-frame"&&e.setAttribute("busy",""),e.setAttribute("aria-busy","true")}function Pe(...i){for(const e of i)e.localName=="turbo-frame"&&e.removeAttribute("busy"),e.removeAttribute("aria-busy")}function Pr(i,e=2e3){return new Promise(t=>{const n=()=>{i.removeEventListener("error",n),i.removeEventListener("load",n),t()};i.addEventListener("load",n,{once:!0}),i.addEventListener("error",n,{once:!0}),setTimeout(t,e)})}function St(i){switch(i){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}function Cr(i){return i=="advance"||i=="replace"||i=="restore"}function te(...i){const e=Re("data-turbo-action",...i);return Cr(e)?e:null}function At(i){return document.querySelector(`meta[name="${i}"]`)}function de(i){const e=At(i);return e&&e.content}function Ir(i,e){let t=At(i);return t||(t=document.createElement("meta"),t.setAttribute("name",i),document.head.appendChild(t)),t.setAttribute("content",e),t}function le(i,e){if(i instanceof Element)return i.closest(e)||le(i.assignedSlot||i.getRootNode()?.host,e)}function Ue(i){return!!i&&i.closest("[inert], :disabled, [hidden], details:not([open]), dialog:not([open])")==null&&typeof i.focus=="function"}function Et(i){return Array.from(i.querySelectorAll("[autofocus]")).find(Ue)}async function Mr(i,e){const t=e();i(),await bt();const n=e();return[t,n]}function Tt(i){if(i==="_blank")return!1;if(i){for(const e of document.getElementsByName(i))if(e instanceof HTMLIFrameElement)return!1;return!0}else return!0}function Lt(i){return le(i,"a[href]:not([target^=_]):not([download])")}function Rt(i){return O(i.getAttribute("href")||"")}function Fr(i,e){let t=null;return(...n)=>{const o=()=>i.apply(this,n);clearTimeout(t),t=setTimeout(o,e)}}class Hr extends Set{constructor(e){super(),this.maxSize=e}add(e){if(this.size>=this.maxSize){const n=this.values().next().value;this.delete(n)}super.add(e)}}const kt=new Hr(20),Or=window.fetch;function Pt(i,e={}){const t=new Headers(e.headers||{}),n=Z();return kt.add(n),t.append("X-Turbo-Request-Id",n),Or(i,{...e,headers:t})}function $e(i){switch(i.toLowerCase()){case"get":return x.get;case"post":return x.post;case"put":return x.put;case"patch":return x.patch;case"delete":return x.delete}}const x={get:"get",post:"post",put:"put",patch:"patch",delete:"delete"};function qr(i){switch(i.toLowerCase()){case K.multipart:return K.multipart;case K.plain:return K.plain;default:return K.urlEncoded}}const K={urlEncoded:"application/x-www-form-urlencoded",multipart:"multipart/form-data",plain:"text/plain"};class ye{abortController=new AbortController;#e=e=>{};constructor(e,t,n,o=new URLSearchParams,h=null,g=K.urlEncoded){const[S,_]=st(O(n),t,o,g);this.delegate=e,this.url=S,this.target=h,this.fetchOptions={credentials:"same-origin",redirect:"follow",method:t.toUpperCase(),headers:{...this.defaultHeaders},body:_,signal:this.abortSignal,referrer:this.delegate.referrer?.href},this.enctype=g}get method(){return this.fetchOptions.method}set method(e){const t=this.isSafe?this.url.searchParams:this.fetchOptions.body||new FormData,n=$e(e)||x.get;this.url.search="";const[o,h]=st(this.url,n,t,this.enctype);this.url=o,this.fetchOptions.body=h,this.fetchOptions.method=n.toUpperCase()}get headers(){return this.fetchOptions.headers}set headers(e){this.fetchOptions.headers=e}get body(){return this.isSafe?this.url.searchParams:this.fetchOptions.body}set body(e){this.fetchOptions.body=e}get location(){return this.url}get params(){return this.url.searchParams}get entries(){return this.body?Array.from(this.body.entries()):[]}cancel(){this.abortController.abort()}async perform(){const{fetchOptions:e}=this;this.delegate.prepareRequest(this);const t=await this.#t(e);try{this.delegate.requestStarted(this),t.detail.fetchRequest?this.response=t.detail.fetchRequest.response:this.response=Pt(this.url.href,e);const n=await this.response;return await this.receive(n)}catch(n){if(n.name!=="AbortError")throw this.#r(n)&&this.delegate.requestErrored(this,n),n}finally{this.delegate.requestFinished(this)}}async receive(e){const t=new We(e);return I("turbo:before-fetch-response",{cancelable:!0,detail:{fetchResponse:t},target:this.target}).defaultPrevented?this.delegate.requestPreventedHandlingResponse(this,t):t.succeeded?this.delegate.requestSucceededWithResponse(this,t):this.delegate.requestFailedWithResponse(this,t),t}get defaultHeaders(){return{Accept:"text/html, application/xhtml+xml"}}get isSafe(){return Ge(this.method)}get abortSignal(){return this.abortController.signal}acceptResponseType(e){this.headers.Accept=[e,this.headers.Accept].join(", ")}async#t(e){const t=new Promise(o=>this.#e=o),n=I("turbo:before-fetch-request",{cancelable:!0,detail:{fetchOptions:e,url:this.url,resume:this.#e},target:this.target});return this.url=n.detail.url,n.defaultPrevented&&await t,n}#r(e){return!I("turbo:fetch-request-error",{target:this.target,cancelable:!0,detail:{request:this,error:e}}).defaultPrevented}}function Ge(i){return $e(i)==x.get}function st(i,e,t,n){const o=Array.from(t).length>0?new URLSearchParams(Ct(t)):i.searchParams;return Ge(e)?[Br(i,o),null]:n==K.urlEncoded?[i,o]:[i,t]}function Ct(i){const e=[];for(const[t,n]of i)n instanceof File||e.push([t,n]);return e}function Br(i,e){const t=new URLSearchParams(Ct(e));return i.search=t.toString(),i}class xr{started=!1;constructor(e,t){this.delegate=e,this.element=t,this.intersectionObserver=new IntersectionObserver(this.intersect)}start(){this.started||(this.started=!0,this.intersectionObserver.observe(this.element))}stop(){this.started&&(this.started=!1,this.intersectionObserver.unobserve(this.element))}intersect=e=>{e.slice(-1)[0]?.isIntersecting&&this.delegate.elementAppearedInViewport(this.element)}}class he{static contentType="text/vnd.turbo-stream.html";static wrap(e){return typeof e=="string"?new this(Tr(e)):e}constructor(e){this.fragment=Dr(e)}}function Dr(i){for(const e of i.querySelectorAll("turbo-stream")){const t=document.importNode(e,!0);for(const n of t.templateElement.content.querySelectorAll("script"))n.replaceWith(_e(n));e.replaceWith(t)}return i}const Vr=100;class Nr{#e=null;#t=null;get(e){if(this.#t&&this.#t.url===e&&this.#t.expire>Date.now())return this.#t.request}setLater(e,t,n){this.clear(),this.#e=setTimeout(()=>{t.perform(),this.set(e,t,n),this.#e=null},Vr)}set(e,t,n){this.#t={url:e,request:t,expire:new Date(new Date().getTime()+n)}}clear(){this.#e&&clearTimeout(this.#e),this.#t=null}}const Wr=10*1e3,oe=new Nr,ie={initialized:"initialized",requesting:"requesting",waiting:"waiting",receiving:"receiving",stopping:"stopping",stopped:"stopped"};class we{state=ie.initialized;static confirmMethod(e,t,n){return Promise.resolve(confirm(e))}constructor(e,t,n,o=!1){const h=jr(t,n),g=Yr(Xr(t,n),h),S=Ur(t,n),_=Qr(t,n);this.delegate=e,this.formElement=t,this.submitter=n,this.fetchRequest=new ye(this,h,g,S,t,_),this.mustRedirect=o}get method(){return this.fetchRequest.method}set method(e){this.fetchRequest.method=e}get action(){return this.fetchRequest.url.toString()}set action(e){this.fetchRequest.url=O(e)}get body(){return this.fetchRequest.body}get enctype(){return this.fetchRequest.enctype}get isSafe(){return this.fetchRequest.isSafe}get location(){return this.fetchRequest.url}async start(){const{initialized:e,requesting:t}=ie,n=Re("data-turbo-confirm",this.submitter,this.formElement);if(!(typeof n=="string"&&!await we.confirmMethod(n,this.formElement,this.submitter))&&this.state==e)return this.state=t,this.fetchRequest.perform()}stop(){const{stopping:e,stopped:t}=ie;if(this.state!=e&&this.state!=t)return this.state=e,this.fetchRequest.cancel(),!0}prepareRequest(e){if(!e.isSafe){const t=$r(de("csrf-param"))||de("csrf-token");t&&(e.headers["X-CSRF-Token"]=t)}this.requestAcceptsTurboStreamResponse(e)&&e.acceptResponseType(he.contentType)}requestStarted(e){this.state=ie.waiting,this.submitter?.setAttribute("disabled",""),this.setSubmitsWith(),ke(this.formElement),I("turbo:submit-start",{target:this.formElement,detail:{formSubmission:this}}),this.delegate.formSubmissionStarted(this)}requestPreventedHandlingResponse(e,t){oe.clear(),this.result={success:t.succeeded,fetchResponse:t}}requestSucceededWithResponse(e,t){if(t.clientError||t.serverError){this.delegate.formSubmissionFailedWithResponse(this,t);return}if(oe.clear(),this.requestMustRedirect(e)&&Gr(t)){const n=new Error("Form responses must redirect to another location");this.delegate.formSubmissionErrored(this,n)}else this.state=ie.receiving,this.result={success:!0,fetchResponse:t},this.delegate.formSubmissionSucceededWithResponse(this,t)}requestFailedWithResponse(e,t){this.result={success:!1,fetchResponse:t},this.delegate.formSubmissionFailedWithResponse(this,t)}requestErrored(e,t){this.result={success:!1,error:t},this.delegate.formSubmissionErrored(this,t)}requestFinished(e){this.state=ie.stopped,this.submitter?.removeAttribute("disabled"),this.resetSubmitterText(),Pe(this.formElement),I("turbo:submit-end",{target:this.formElement,detail:{formSubmission:this,...this.result}}),this.delegate.formSubmissionFinished(this)}setSubmitsWith(){if(!(!this.submitter||!this.submitsWith)){if(this.submitter.matches("button"))this.originalSubmitText=this.submitter.innerHTML,this.submitter.innerHTML=this.submitsWith;else if(this.submitter.matches("input")){const e=this.submitter;this.originalSubmitText=e.value,e.value=this.submitsWith}}}resetSubmitterText(){if(!(!this.submitter||!this.originalSubmitText)){if(this.submitter.matches("button"))this.submitter.innerHTML=this.originalSubmitText;else if(this.submitter.matches("input")){const e=this.submitter;e.value=this.originalSubmitText}}}requestMustRedirect(e){return!e.isSafe&&this.mustRedirect}requestAcceptsTurboStreamResponse(e){return!e.isSafe||kr("data-turbo-stream",this.submitter,this.formElement)}get submitsWith(){return this.submitter?.getAttribute("data-turbo-submits-with")}}function Ur(i,e){const t=new FormData(i),n=e?.getAttribute("name"),o=e?.getAttribute("value");return n&&t.append(n,o||""),t}function $r(i){if(i!=null){const t=(document.cookie?document.cookie.split("; "):[]).find(n=>n.startsWith(i));if(t){const n=t.split("=").slice(1).join("=");return n?decodeURIComponent(n):void 0}}}function Gr(i){return i.statusCode==200&&!i.redirected}function Xr(i,e){const t=typeof i.action=="string"?i.action:null;return e?.hasAttribute("formaction")?e.getAttribute("formaction")||"":i.getAttribute("action")||t||""}function Yr(i,e){const t=O(i);return Ge(e)&&(t.search=""),t}function jr(i,e){const t=e?.getAttribute("formmethod")||i.getAttribute("method")||"";return $e(t.toLowerCase())||x.get}function Qr(i,e){return qr(e?.getAttribute("formenctype")||i.enctype)}class Me{constructor(e){this.element=e}get activeElement(){return this.element.ownerDocument.activeElement}get children(){return[...this.element.children]}hasAnchor(e){return this.getElementForAnchor(e)!=null}getElementForAnchor(e){return e?this.element.querySelector(`[id='${e}'], a[name='${e}']`):null}get isConnected(){return this.element.isConnected}get firstAutofocusableElement(){return Et(this.element)}get permanentElements(){return Mt(this.element)}getPermanentElementById(e){return It(this.element,e)}getPermanentElementMapForSnapshot(e){const t={};for(const n of this.permanentElements){const{id:o}=n,h=e.getPermanentElementById(o);h&&(t[o]=[n,h])}return t}}function It(i,e){return i.querySelector(`#${e}[data-turbo-permanent]`)}function Mt(i){return i.querySelectorAll("[id][data-turbo-permanent]")}class Xe{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("submit",this.submitCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("submit",this.submitCaptured,!0),this.started=!1)}submitCaptured=()=>{this.eventTarget.removeEventListener("submit",this.submitBubbled,!1),this.eventTarget.addEventListener("submit",this.submitBubbled,!1)};submitBubbled=e=>{if(!e.defaultPrevented){const t=e.target instanceof HTMLFormElement?e.target:void 0,n=e.submitter||void 0;t&&Zr(t,n)&&Jr(t,n)&&this.delegate.willSubmitForm(t,n)&&(e.preventDefault(),e.stopImmediatePropagation(),this.delegate.formSubmitted(t,n))}}}function Zr(i,e){return(e?.getAttribute("formmethod")||i.getAttribute("method"))!="dialog"}function Jr(i,e){const t=e?.getAttribute("formtarget")||i.getAttribute("target");return Tt(t)}class Ft{#e=e=>{};#t=e=>{};constructor(e,t){this.delegate=e,this.element=t}scrollToAnchor(e){const t=this.snapshot.getElementForAnchor(e);t?(this.scrollToElement(t),this.focusElement(t)):this.scrollToPosition({x:0,y:0})}scrollToAnchorFromLocation(e){this.scrollToAnchor(ee(e))}scrollToElement(e){e.scrollIntoView()}focusElement(e){e instanceof HTMLElement&&(e.hasAttribute("tabindex")?e.focus():(e.setAttribute("tabindex","-1"),e.focus(),e.removeAttribute("tabindex")))}scrollToPosition({x:e,y:t}){this.scrollRoot.scrollTo(e,t)}scrollToTop(){this.scrollToPosition({x:0,y:0})}get scrollRoot(){return window}async render(e){const{isPreview:t,shouldRender:n,willRender:o,newSnapshot:h}=e,g=o;if(n)try{this.renderPromise=new Promise(R=>this.#e=R),this.renderer=e,await this.prepareToRenderSnapshot(e);const S=new Promise(R=>this.#t=R),_={resume:this.#t,render:this.renderer.renderElement,renderMethod:this.renderer.renderMethod};this.delegate.allowsImmediateRender(h,_)||await S,await this.renderSnapshot(e),this.delegate.viewRenderedSnapshot(h,t,this.renderer.renderMethod),this.delegate.preloadOnLoadLinksForView(this.element),this.finishRenderingSnapshot(e)}finally{delete this.renderer,this.#e(void 0),delete this.renderPromise}else g&&this.invalidate(e.reloadReason)}invalidate(e){this.delegate.viewInvalidated(e)}async prepareToRenderSnapshot(e){this.markAsPreview(e.isPreview),await e.prepareToRender()}markAsPreview(e){e?this.element.setAttribute("data-turbo-preview",""):this.element.removeAttribute("data-turbo-preview")}markVisitDirection(e){this.element.setAttribute("data-turbo-visit-direction",e)}unmarkVisitDirection(){this.element.removeAttribute("data-turbo-visit-direction")}async renderSnapshot(e){await e.render()}finishRenderingSnapshot(e){e.finishRendering()}}class zr extends Ft{missing(){this.element.innerHTML='<strong class="turbo-frame-error">Content missing</strong>'}get snapshot(){return new Me(this.element)}}class Ht{constructor(e,t){this.delegate=e,this.element=t}start(){this.element.addEventListener("click",this.clickBubbled),document.addEventListener("turbo:click",this.linkClicked),document.addEventListener("turbo:before-visit",this.willVisit)}stop(){this.element.removeEventListener("click",this.clickBubbled),document.removeEventListener("turbo:click",this.linkClicked),document.removeEventListener("turbo:before-visit",this.willVisit)}clickBubbled=e=>{this.clickEventIsSignificant(e)?this.clickEvent=e:delete this.clickEvent};linkClicked=e=>{this.clickEvent&&this.clickEventIsSignificant(e)&&this.delegate.shouldInterceptLinkClick(e.target,e.detail.url,e.detail.originalEvent)&&(this.clickEvent.preventDefault(),e.preventDefault(),this.delegate.linkClickIntercepted(e.target,e.detail.url,e.detail.originalEvent)),delete this.clickEvent};willVisit=e=>{delete this.clickEvent};clickEventIsSignificant(e){const t=e.composed?e.target?.parentElement:e.target,n=Lt(t)||t;return n instanceof Element&&n.closest("turbo-frame, html")==this.element}}class Ot{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("click",this.clickCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("click",this.clickCaptured,!0),this.started=!1)}clickCaptured=()=>{this.eventTarget.removeEventListener("click",this.clickBubbled,!1),this.eventTarget.addEventListener("click",this.clickBubbled,!1)};clickBubbled=e=>{if(e instanceof MouseEvent&&this.clickEventIsSignificant(e)){const t=e.composedPath&&e.composedPath()[0]||e.target,n=Lt(t);if(n&&Tt(n.target)){const o=Rt(n);this.delegate.willFollowLinkToLocation(n,o,e)&&(e.preventDefault(),this.delegate.followedLinkToLocation(n,o))}}};clickEventIsSignificant(e){return!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)}}class qt{constructor(e,t){this.delegate=e,this.linkInterceptor=new Ot(this,t)}start(){this.linkInterceptor.start()}stop(){this.linkInterceptor.stop()}canPrefetchRequestToLocation(e,t){return!1}prefetchAndCacheRequestToLocation(e,t){}willFollowLinkToLocation(e,t,n){return this.delegate.willSubmitFormLinkToLocation(e,t,n)&&(e.hasAttribute("data-turbo-method")||e.hasAttribute("data-turbo-stream"))}followedLinkToLocation(e,t){const n=document.createElement("form"),o="hidden";for(const[r,s]of t.searchParams)n.append(Object.assign(document.createElement("input"),{type:o,name:r,value:s}));const h=Object.assign(t,{search:""});n.setAttribute("data-turbo","true"),n.setAttribute("action",h.href),n.setAttribute("hidden","");const g=e.getAttribute("data-turbo-method");g&&n.setAttribute("method",g);const S=e.getAttribute("data-turbo-frame");S&&n.setAttribute("data-turbo-frame",S);const _=te(e);_&&n.setAttribute("data-turbo-action",_);const b=e.getAttribute("data-turbo-confirm");b&&n.setAttribute("data-turbo-confirm",b),e.hasAttribute("data-turbo-stream")&&n.setAttribute("data-turbo-stream",""),this.delegate.submittedFormLinkToLocation(e,t,n),document.body.appendChild(n),n.addEventListener("turbo:submit-end",()=>n.remove(),{once:!0}),requestAnimationFrame(()=>n.requestSubmit())}}class Bt{static async preservingPermanentElements(e,t,n){const o=new this(e,t);o.enter(),await n(),o.leave()}constructor(e,t){this.delegate=e,this.permanentElementMap=t}enter(){for(const e in this.permanentElementMap){const[t,n]=this.permanentElementMap[e];this.delegate.enteringBardo(t,n),this.replaceNewPermanentElementWithPlaceholder(n)}}leave(){for(const e in this.permanentElementMap){const[t]=this.permanentElementMap[e];this.replaceCurrentPermanentElementWithClone(t),this.replacePlaceholderWithPermanentElement(t),this.delegate.leavingBardo(t)}}replaceNewPermanentElementWithPlaceholder(e){const t=Kr(e);e.replaceWith(t)}replaceCurrentPermanentElementWithClone(e){const t=e.cloneNode(!0);e.replaceWith(t)}replacePlaceholderWithPermanentElement(e){this.getPlaceholderById(e.id)?.replaceWith(e)}getPlaceholderById(e){return this.placeholders.find(t=>t.content==e)}get placeholders(){return[...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]}}function Kr(i){const e=document.createElement("meta");return e.setAttribute("name","turbo-permanent-placeholder"),e.setAttribute("content",i.id),e}class Ye{#e=null;constructor(e,t,n,o,h=!0){this.currentSnapshot=e,this.newSnapshot=t,this.isPreview=o,this.willRender=h,this.renderElement=n,this.promise=new Promise((g,S)=>this.resolvingFunctions={resolve:g,reject:S})}get shouldRender(){return!0}get shouldAutofocus(){return!0}get reloadReason(){}prepareToRender(){}render(){}finishRendering(){this.resolvingFunctions&&(this.resolvingFunctions.resolve(),delete this.resolvingFunctions)}async preservingPermanentElements(e){await Bt.preservingPermanentElements(this,this.permanentElementMap,e)}focusFirstAutofocusableElement(){if(this.shouldAutofocus){const e=this.connectedSnapshot.firstAutofocusableElement;e&&e.focus()}}enteringBardo(e){this.#e||e.contains(this.currentSnapshot.activeElement)&&(this.#e=this.currentSnapshot.activeElement)}leavingBardo(e){e.contains(this.#e)&&this.#e instanceof HTMLElement&&(this.#e.focus(),this.#e=null)}get connectedSnapshot(){return this.newSnapshot.isConnected?this.newSnapshot:this.currentSnapshot}get currentElement(){return this.currentSnapshot.element}get newElement(){return this.newSnapshot.element}get permanentElementMap(){return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)}get renderMethod(){return"replace"}}class Ce extends Ye{static renderElement(e,t){const n=document.createRange();n.selectNodeContents(e),n.deleteContents();const o=t,h=o.ownerDocument?.createRange();h&&(h.selectNodeContents(o),e.appendChild(h.extractContents()))}constructor(e,t,n,o,h,g=!0){super(t,n,o,h,g),this.delegate=e}get shouldRender(){return!0}async render(){await ae(),this.preservingPermanentElements(()=>{this.loadFrameElement()}),this.scrollFrameIntoView(),await ae(),this.focusFirstAutofocusableElement(),await ae(),this.activateScriptElements()}loadFrameElement(){this.delegate.willRenderFrame(this.currentElement,this.newElement),this.renderElement(this.currentElement,this.newElement)}scrollFrameIntoView(){if(this.currentElement.autoscroll||this.newElement.autoscroll){const e=this.currentElement.firstElementChild,t=en(this.currentElement.getAttribute("data-autoscroll-block"),"end"),n=tn(this.currentElement.getAttribute("data-autoscroll-behavior"),"auto");if(e)return e.scrollIntoView({block:t,behavior:n}),!0}return!1}activateScriptElements(){for(const e of this.newScriptElements){const t=_e(e);e.replaceWith(t)}}get newScriptElements(){return this.currentElement.querySelectorAll("script")}}function en(i,e){return i=="end"||i=="start"||i=="center"||i=="nearest"?i:e}function tn(i,e){return i=="auto"||i=="smooth"?i:e}class j{static animationDuration=300;static get defaultCSS(){return wt`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${j.animationDuration}ms ease-out,
          opacity ${j.animationDuration/2}ms ${j.animationDuration/2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `}hiding=!1;value=0;visible=!1;constructor(){this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement(),this.installStylesheetElement(),this.setValue(0)}show(){this.visible||(this.visible=!0,this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement(()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1}))}setValue(e){this.value=e,this.refresh()}installStylesheetElement(){document.head.insertBefore(this.stylesheetElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()}fadeProgressElement(e){this.progressElement.style.opacity="0",setTimeout(e,j.animationDuration*1.5)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,j.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}trickle=()=>{this.setValue(this.value+Math.random()/100)};refresh(){requestAnimationFrame(()=>{this.progressElement.style.width=`${10+this.value*90}%`})}createStylesheetElement(){const e=document.createElement("style");return e.type="text/css",e.textContent=j.defaultCSS,this.cspNonce&&(e.nonce=this.cspNonce),e}createProgressElement(){const e=document.createElement("div");return e.className="turbo-progress-bar",e}get cspNonce(){return de("csp-nonce")}}class rn extends Me{detailsByOuterHTML=this.children.filter(e=>!an(e)).map(e=>un(e)).reduce((e,t)=>{const{outerHTML:n}=t,o=n in e?e[n]:{type:nn(t),tracked:sn(t),elements:[]};return{...e,[n]:{...o,elements:[...o.elements,t]}}},{});get trackedElementSignature(){return Object.keys(this.detailsByOuterHTML).filter(e=>this.detailsByOuterHTML[e].tracked).join("")}getScriptElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("script",e)}getStylesheetElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("stylesheet",e)}getElementsMatchingTypeNotInSnapshot(e,t){return Object.keys(this.detailsByOuterHTML).filter(n=>!(n in t.detailsByOuterHTML)).map(n=>this.detailsByOuterHTML[n]).filter(({type:n})=>n==e).map(({elements:[n]})=>n)}get provisionalElements(){return Object.keys(this.detailsByOuterHTML).reduce((e,t)=>{const{type:n,tracked:o,elements:h}=this.detailsByOuterHTML[t];return n==null&&!o?[...e,...h]:h.length>1?[...e,...h.slice(1)]:e},[])}getMetaValue(e){const t=this.findMetaElementByName(e);return t?t.getAttribute("content"):null}findMetaElementByName(e){return Object.keys(this.detailsByOuterHTML).reduce((t,n)=>{const{elements:[o]}=this.detailsByOuterHTML[n];return cn(o,e)?o:t},void 0|void 0)}}function nn(i){if(on(i))return"script";if(ln(i))return"stylesheet"}function sn(i){return i.getAttribute("data-turbo-track")=="reload"}function on(i){return i.localName=="script"}function an(i){return i.localName=="noscript"}function ln(i){const e=i.localName;return e=="style"||e=="link"&&i.getAttribute("rel")=="stylesheet"}function cn(i,e){return i.localName=="meta"&&i.getAttribute("name")==e}function un(i){return i.hasAttribute("nonce")&&i.setAttribute("nonce",""),i}class D extends Me{static fromHTMLString(e=""){return this.fromDocument(yt(e))}static fromElement(e){return this.fromDocument(e.ownerDocument)}static fromDocument({documentElement:e,body:t,head:n}){return new this(e,t,new rn(n))}constructor(e,t,n){super(t),this.documentElement=e,this.headSnapshot=n}clone(){const e=this.element.cloneNode(!0),t=this.element.querySelectorAll("select"),n=e.querySelectorAll("select");for(const[o,h]of t.entries()){const g=n[o];for(const S of g.selectedOptions)S.selected=!1;for(const S of h.selectedOptions)g.options[S.index].selected=!0}for(const o of e.querySelectorAll('input[type="password"]'))o.value="";return new D(this.documentElement,e,this.headSnapshot)}get lang(){return this.documentElement.getAttribute("lang")}get headElement(){return this.headSnapshot.element}get rootLocation(){const e=this.getSetting("root")??"/";return O(e)}get cacheControlValue(){return this.getSetting("cache-control")}get isPreviewable(){return this.cacheControlValue!="no-preview"}get isCacheable(){return this.cacheControlValue!="no-cache"}get isVisitable(){return this.getSetting("visit-control")!="reload"}get prefersViewTransitions(){return this.headSnapshot.getMetaValue("view-transition")==="same-origin"}get shouldMorphPage(){return this.getSetting("refresh-method")==="morph"}get shouldPreserveScrollPosition(){return this.getSetting("refresh-scroll")==="preserve"}getSetting(e){return this.headSnapshot.getMetaValue(`turbo-${e}`)}}class dn{#e=!1;#t=Promise.resolve();renderChange(e,t){return e&&this.viewTransitionsAvailable&&!this.#e?(this.#e=!0,this.#t=this.#t.then(async()=>{await document.startViewTransition(t).finished})):this.#t=this.#t.then(t),this.#t}get viewTransitionsAvailable(){return document.startViewTransition}}const hn={action:"advance",historyChanged:!1,visitCachedSnapshot:()=>{},willRender:!0,updateHistory:!0,shouldCacheSnapshot:!0,acceptsStreamResponse:!1},Te={visitStart:"visitStart",requestStart:"requestStart",requestEnd:"requestEnd",visitEnd:"visitEnd"},G={initialized:"initialized",started:"started",canceled:"canceled",failed:"failed",completed:"completed"},ce={networkFailure:0,timeoutFailure:-1,contentTypeMismatch:-2},fn={advance:"forward",restore:"back",replace:"none"};class mn{identifier=Z();timingMetrics={};followedRedirect=!1;historyChanged=!1;scrolled=!1;shouldCacheSnapshot=!0;acceptsStreamResponse=!1;snapshotCached=!1;state=G.initialized;viewTransitioner=new dn;constructor(e,t,n,o={}){this.delegate=e,this.location=t,this.restorationIdentifier=n||Z();const{action:h,historyChanged:g,referrer:S,snapshot:_,snapshotHTML:b,response:R,visitCachedSnapshot:r,willRender:s,updateHistory:a,shouldCacheSnapshot:c,acceptsStreamResponse:m,direction:p}={...hn,...o};this.action=h,this.historyChanged=g,this.referrer=S,this.snapshot=_,this.snapshotHTML=b,this.response=R,this.isSamePage=this.delegate.locationWithActionIsSamePage(this.location,this.action),this.isPageRefresh=this.view.isPageRefresh(this),this.visitCachedSnapshot=r,this.willRender=s,this.updateHistory=a,this.scrolled=!s,this.shouldCacheSnapshot=c,this.acceptsStreamResponse=m,this.direction=p||fn[h]}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}get restorationData(){return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)}get silent(){return this.isSamePage}start(){this.state==G.initialized&&(this.recordTimingMetric(Te.visitStart),this.state=G.started,this.adapter.visitStarted(this),this.delegate.visitStarted(this))}cancel(){this.state==G.started&&(this.request&&this.request.cancel(),this.cancelRender(),this.state=G.canceled)}complete(){this.state==G.started&&(this.recordTimingMetric(Te.visitEnd),this.adapter.visitCompleted(this),this.state=G.completed,this.followRedirect(),this.followedRedirect||this.delegate.visitCompleted(this))}fail(){this.state==G.started&&(this.state=G.failed,this.adapter.visitFailed(this),this.delegate.visitCompleted(this))}changeHistory(){if(!this.historyChanged&&this.updateHistory){const e=this.location.href===this.referrer?.href?"replace":this.action,t=St(e);this.history.update(t,this.location,this.restorationIdentifier),this.historyChanged=!0}}issueRequest(){this.hasPreloadedResponse()?this.simulateRequest():this.shouldIssueRequest()&&!this.request&&(this.request=new ye(this,x.get,this.location),this.request.perform())}simulateRequest(){this.response&&(this.startRequest(),this.recordResponse(),this.finishRequest())}startRequest(){this.recordTimingMetric(Te.requestStart),this.adapter.visitRequestStarted(this)}recordResponse(e=this.response){if(this.response=e,e){const{statusCode:t}=e;ot(t)?this.adapter.visitRequestCompleted(this):this.adapter.visitRequestFailedWithStatusCode(this,t)}}finishRequest(){this.recordTimingMetric(Te.requestEnd),this.adapter.visitRequestFinished(this)}loadResponse(){if(this.response){const{statusCode:e,responseHTML:t}=this.response;this.render(async()=>{if(this.shouldCacheSnapshot&&this.cacheSnapshot(),this.view.renderPromise&&await this.view.renderPromise,ot(e)&&t!=null){const n=D.fromHTMLString(t);await this.renderPageSnapshot(n,!1),this.adapter.visitRendered(this),this.complete()}else await this.view.renderError(D.fromHTMLString(t),this),this.adapter.visitRendered(this),this.fail()})}}getCachedSnapshot(){const e=this.view.getCachedSnapshotForLocation(this.location)||this.getPreloadedSnapshot();if(e&&(!ee(this.location)||e.hasAnchor(ee(this.location)))&&(this.action=="restore"||e.isPreviewable))return e}getPreloadedSnapshot(){if(this.snapshotHTML)return D.fromHTMLString(this.snapshotHTML)}hasCachedSnapshot(){return this.getCachedSnapshot()!=null}loadCachedSnapshot(){const e=this.getCachedSnapshot();if(e){const t=this.shouldIssueRequest();this.render(async()=>{this.cacheSnapshot(),this.isSamePage||this.isPageRefresh?this.adapter.visitRendered(this):(this.view.renderPromise&&await this.view.renderPromise,await this.renderPageSnapshot(e,t),this.adapter.visitRendered(this),t||this.complete())})}}followRedirect(){this.redirectedToLocation&&!this.followedRedirect&&this.response?.redirected&&(this.adapter.visitProposedToLocation(this.redirectedToLocation,{action:"replace",response:this.response,shouldCacheSnapshot:!1,willRender:!1}),this.followedRedirect=!0)}goToSamePageAnchor(){this.isSamePage&&this.render(async()=>{this.cacheSnapshot(),this.performScroll(),this.changeHistory(),this.adapter.visitRendered(this)})}prepareRequest(e){this.acceptsStreamResponse&&e.acceptResponseType(he.contentType)}requestStarted(){this.startRequest()}requestPreventedHandlingResponse(e,t){}async requestSucceededWithResponse(e,t){const n=await t.responseHTML,{redirected:o,statusCode:h}=t;n==null?this.recordResponse({statusCode:ce.contentTypeMismatch,redirected:o}):(this.redirectedToLocation=t.redirected?t.location:void 0,this.recordResponse({statusCode:h,responseHTML:n,redirected:o}))}async requestFailedWithResponse(e,t){const n=await t.responseHTML,{redirected:o,statusCode:h}=t;n==null?this.recordResponse({statusCode:ce.contentTypeMismatch,redirected:o}):this.recordResponse({statusCode:h,responseHTML:n,redirected:o})}requestErrored(e,t){this.recordResponse({statusCode:ce.networkFailure,redirected:!1})}requestFinished(){this.finishRequest()}performScroll(){!this.scrolled&&!this.view.forceReloaded&&!this.view.shouldPreserveScrollPosition(this)&&(this.action=="restore"?this.scrollToRestoredPosition()||this.scrollToAnchor()||this.view.scrollToTop():this.scrollToAnchor()||this.view.scrollToTop(),this.isSamePage&&this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation,this.location),this.scrolled=!0)}scrollToRestoredPosition(){const{scrollPosition:e}=this.restorationData;if(e)return this.view.scrollToPosition(e),!0}scrollToAnchor(){const e=ee(this.location);if(e!=null)return this.view.scrollToAnchor(e),!0}recordTimingMetric(e){this.timingMetrics[e]=new Date().getTime()}getTimingMetrics(){return{...this.timingMetrics}}getHistoryMethodForAction(e){switch(e){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}hasPreloadedResponse(){return typeof this.response=="object"}shouldIssueRequest(){return this.isSamePage?!1:this.action=="restore"?!this.hasCachedSnapshot():this.willRender}cacheSnapshot(){this.snapshotCached||(this.view.cacheSnapshot(this.snapshot).then(e=>e&&this.visitCachedSnapshot(e)),this.snapshotCached=!0)}async render(e){this.cancelRender(),this.frame=await ae(),await e(),delete this.frame}async renderPageSnapshot(e,t){await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(e),async()=>{await this.view.renderPage(e,t,this.willRender,this),this.performScroll()})}cancelRender(){this.frame&&(cancelAnimationFrame(this.frame),delete this.frame)}}function ot(i){return i>=200&&i<300}class pn{progressBar=new j;constructor(e){this.session=e}visitProposedToLocation(e,t){Q(e,this.navigator.rootLocation)?this.navigator.startVisit(e,t?.restorationIdentifier||Z(),t):window.location.href=e.toString()}visitStarted(e){this.location=e.location,e.loadCachedSnapshot(),e.issueRequest(),e.goToSamePageAnchor()}visitRequestStarted(e){this.progressBar.setValue(0),e.hasCachedSnapshot()||e.action!="restore"?this.showVisitProgressBarAfterDelay():this.showProgressBar()}visitRequestCompleted(e){e.loadResponse()}visitRequestFailedWithStatusCode(e,t){switch(t){case ce.networkFailure:case ce.timeoutFailure:case ce.contentTypeMismatch:return this.reload({reason:"request_failed",context:{statusCode:t}});default:return e.loadResponse()}}visitRequestFinished(e){}visitCompleted(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}pageInvalidated(e){this.reload(e)}visitFailed(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}visitRendered(e){}formSubmissionStarted(e){this.progressBar.setValue(0),this.showFormProgressBarAfterDelay()}formSubmissionFinished(e){this.progressBar.setValue(1),this.hideFormProgressBar()}showVisitProgressBarAfterDelay(){this.visitProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay)}hideVisitProgressBar(){this.progressBar.hide(),this.visitProgressBarTimeout!=null&&(window.clearTimeout(this.visitProgressBarTimeout),delete this.visitProgressBarTimeout)}showFormProgressBarAfterDelay(){this.formProgressBarTimeout==null&&(this.formProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay))}hideFormProgressBar(){this.progressBar.hide(),this.formProgressBarTimeout!=null&&(window.clearTimeout(this.formProgressBarTimeout),delete this.formProgressBarTimeout)}showProgressBar=()=>{this.progressBar.show()};reload(e){I("turbo:reload",{detail:e}),window.location.href=this.location?.toString()||window.location.href}get navigator(){return this.session.navigator}}class gn{selector="[data-turbo-temporary]";deprecatedSelector="[data-turbo-cache=false]";started=!1;start(){this.started||(this.started=!0,addEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}removeTemporaryElements=e=>{for(const t of this.temporaryElements)t.remove()};get temporaryElements(){return[...document.querySelectorAll(this.selector),...this.temporaryElementsWithDeprecation]}get temporaryElementsWithDeprecation(){const e=document.querySelectorAll(this.deprecatedSelector);return e.length&&console.warn(`The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`),[...e]}}class vn{constructor(e,t){this.session=e,this.element=t,this.linkInterceptor=new Ht(this,t),this.formSubmitObserver=new Xe(this,t)}start(){this.linkInterceptor.start(),this.formSubmitObserver.start()}stop(){this.linkInterceptor.stop(),this.formSubmitObserver.stop()}shouldInterceptLinkClick(e,t,n){return this.#t(e)}linkClickIntercepted(e,t,n){const o=this.#r(e);o&&o.delegate.linkClickIntercepted(e,t,n)}willSubmitForm(e,t){return e.closest("turbo-frame")==null&&this.#e(e,t)&&this.#t(e,t)}formSubmitted(e,t){const n=this.#r(e,t);n&&n.delegate.formSubmitted(e,t)}#e(e,t){const n=Ne(e,t),o=this.element.ownerDocument.querySelector('meta[name="turbo-root"]'),h=O(o?.content??"/");return this.#t(e,t)&&Q(n,h)}#t(e,t){if(e instanceof HTMLFormElement?this.session.submissionIsNavigatable(e,t):this.session.elementIsNavigatable(e)){const o=this.#r(e,t);return o?o!=e.closest("turbo-frame"):!1}else return!1}#r(e,t){const n=t?.getAttribute("data-turbo-frame")||e.getAttribute("data-turbo-frame");if(n&&n!="_top"){const o=this.element.querySelector(`#${n}:not([disabled])`);if(o instanceof V)return o}}}class bn{location;restorationIdentifier=Z();restorationData={};started=!1;pageLoaded=!1;currentIndex=0;constructor(e){this.delegate=e}start(){this.started||(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.currentIndex=history.state?.turbo?.restorationIndex||0,this.started=!0,this.replace(new URL(window.location.href)))}stop(){this.started&&(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1)}push(e,t){this.update(history.pushState,e,t)}replace(e,t){this.update(history.replaceState,e,t)}update(e,t,n=Z()){e===history.pushState&&++this.currentIndex;const o={turbo:{restorationIdentifier:n,restorationIndex:this.currentIndex}};e.call(history,o,"",t.href),this.location=t,this.restorationIdentifier=n}getRestorationDataForIdentifier(e){return this.restorationData[e]||{}}updateRestorationData(e){const{restorationIdentifier:t}=this,n=this.restorationData[t];this.restorationData[t]={...n,...e}}assumeControlOfScrollRestoration(){this.previousScrollRestoration||(this.previousScrollRestoration=history.scrollRestoration??"auto",history.scrollRestoration="manual")}relinquishControlOfScrollRestoration(){this.previousScrollRestoration&&(history.scrollRestoration=this.previousScrollRestoration,delete this.previousScrollRestoration)}onPopState=e=>{if(this.shouldHandlePopState()){const{turbo:t}=e.state||{};if(t){this.location=new URL(window.location.href);const{restorationIdentifier:n,restorationIndex:o}=t;this.restorationIdentifier=n;const h=o>this.currentIndex?"forward":"back";this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location,n,h),this.currentIndex=o}}};onPageLoad=async e=>{await Lr(),this.pageLoaded=!0};shouldHandlePopState(){return this.pageIsLoaded()}pageIsLoaded(){return this.pageLoaded||document.readyState=="complete"}}class _n{started=!1;#e=null;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.readyState==="loading"?this.eventTarget.addEventListener("DOMContentLoaded",this.#t,{once:!0}):this.#t())}stop(){this.started&&(this.eventTarget.removeEventListener("mouseenter",this.#r,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("mouseleave",this.#i,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("turbo:before-fetch-request",this.#n,!0),this.started=!1)}#t=()=>{this.eventTarget.addEventListener("mouseenter",this.#r,{capture:!0,passive:!0}),this.eventTarget.addEventListener("mouseleave",this.#i,{capture:!0,passive:!0}),this.eventTarget.addEventListener("turbo:before-fetch-request",this.#n,!0),this.started=!0};#r=e=>{if(de("turbo-prefetch")==="false")return;const t=e.target;if(t.matches&&t.matches("a[href]:not([target^=_]):not([download])")&&this.#l(t)){const o=t,h=Rt(o);if(this.delegate.canPrefetchRequestToLocation(o,h)){this.#e=o;const g=new ye(this,x.get,h,new URLSearchParams,t);oe.setLater(h.toString(),g,this.#a)}}};#i=e=>{e.target===this.#e&&this.#s()};#s=()=>{oe.clear(),this.#e=null};#n=e=>{if(e.target.tagName!=="FORM"&&e.detail.fetchOptions.method==="GET"){const t=oe.get(e.detail.url.toString());t&&(e.detail.fetchRequest=t),oe.clear()}};prepareRequest(e){const t=e.target;e.headers["X-Sec-Purpose"]="prefetch";const n=t.closest("turbo-frame"),o=t.getAttribute("data-turbo-frame")||n?.getAttribute("target")||n?.id;o&&o!=="_top"&&(e.headers["Turbo-Frame"]=o)}requestSucceededWithResponse(){}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}get#a(){return Number(de("turbo-prefetch-cache-time"))||Wr}#l(e){return!(!e.getAttribute("href")||yn(e)||wn(e)||Sn(e)||An(e)||Tn(e))}}const yn=i=>i.origin!==document.location.origin||!["http:","https:"].includes(i.protocol)||i.hasAttribute("target"),wn=i=>i.pathname+i.search===document.location.pathname+document.location.search||i.href.startsWith("#"),Sn=i=>{if(i.getAttribute("data-turbo-prefetch")==="false"||i.getAttribute("data-turbo")==="false")return!0;const e=le(i,"[data-turbo-prefetch]");return!!(e&&e.getAttribute("data-turbo-prefetch")==="false")},An=i=>{const e=i.getAttribute("data-turbo-method");return!!(e&&e.toLowerCase()!=="get"||En(i)||i.hasAttribute("data-turbo-confirm")||i.hasAttribute("data-turbo-stream"))},En=i=>i.hasAttribute("data-remote")||i.hasAttribute("data-behavior")||i.hasAttribute("data-confirm")||i.hasAttribute("data-method"),Tn=i=>I("turbo:before-prefetch",{target:i,cancelable:!0}).defaultPrevented;class Ln{constructor(e){this.delegate=e}proposeVisit(e,t={}){this.delegate.allowsVisitingLocationWithAction(e,t.action)&&this.delegate.visitProposedToLocation(e,t)}startVisit(e,t,n={}){this.stop(),this.currentVisit=new mn(this,O(e),t,{referrer:this.location,...n}),this.currentVisit.start()}submitForm(e,t){this.stop(),this.formSubmission=new we(this,e,t,!0),this.formSubmission.start()}stop(){this.formSubmission&&(this.formSubmission.stop(),delete this.formSubmission),this.currentVisit&&(this.currentVisit.cancel(),delete this.currentVisit)}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get rootLocation(){return this.view.snapshot.rootLocation}get history(){return this.delegate.history}formSubmissionStarted(e){typeof this.adapter.formSubmissionStarted=="function"&&this.adapter.formSubmissionStarted(e)}async formSubmissionSucceededWithResponse(e,t){if(e==this.formSubmission){const n=await t.responseHTML;if(n){const o=e.isSafe;o||this.view.clearSnapshotCache();const{statusCode:h,redirected:g}=t,_={action:this.#e(e,t),shouldCacheSnapshot:o,response:{statusCode:h,responseHTML:n,redirected:g}};this.proposeVisit(t.location,_)}}}async formSubmissionFailedWithResponse(e,t){const n=await t.responseHTML;if(n){const o=D.fromHTMLString(n);t.serverError?await this.view.renderError(o,this.currentVisit):await this.view.renderPage(o,!1,!0,this.currentVisit),o.shouldPreserveScrollPosition||this.view.scrollToTop(),this.view.clearSnapshotCache()}}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished(e){typeof this.adapter.formSubmissionFinished=="function"&&this.adapter.formSubmissionFinished(e)}visitStarted(e){this.delegate.visitStarted(e)}visitCompleted(e){this.delegate.visitCompleted(e),delete this.currentVisit}locationWithActionIsSamePage(e,t){const n=ee(e),o=ee(this.view.lastRenderedLocation),h=t==="restore"&&typeof n>"u";return t!=="replace"&&Be(e)===Be(this.view.lastRenderedLocation)&&(h||n!=null&&n!==o)}visitScrolledToSamePageLocation(e,t){this.delegate.visitScrolledToSamePageLocation(e,t)}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}#e(e,t){const{submitter:n,formElement:o}=e;return te(n,o)||this.#t(t)}#t(e){return e.redirected&&e.location.href===this.location?.href?"replace":"advance"}}const z={initial:0,loading:1,interactive:2,complete:3};class Rn{stage=z.initial;started=!1;constructor(e){this.delegate=e}start(){this.started||(this.stage==z.initial&&(this.stage=z.loading),document.addEventListener("readystatechange",this.interpretReadyState,!1),addEventListener("pagehide",this.pageWillUnload,!1),this.started=!0)}stop(){this.started&&(document.removeEventListener("readystatechange",this.interpretReadyState,!1),removeEventListener("pagehide",this.pageWillUnload,!1),this.started=!1)}interpretReadyState=()=>{const{readyState:e}=this;e=="interactive"?this.pageIsInteractive():e=="complete"&&this.pageIsComplete()};pageIsInteractive(){this.stage==z.loading&&(this.stage=z.interactive,this.delegate.pageBecameInteractive())}pageIsComplete(){this.pageIsInteractive(),this.stage==z.interactive&&(this.stage=z.complete,this.delegate.pageLoaded())}pageWillUnload=()=>{this.delegate.pageWillUnload()};get readyState(){return document.readyState}}class kn{started=!1;constructor(e){this.delegate=e}start(){this.started||(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)}stop(){this.started&&(removeEventListener("scroll",this.onScroll,!1),this.started=!1)}onScroll=()=>{this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})};updatePosition(e){this.delegate.scrollPositionChanged(e)}}class Pn{render({fragment:e}){Bt.preservingPermanentElements(this,Cn(e),()=>{In(e,()=>{Mn(()=>{document.documentElement.appendChild(e)})})})}enteringBardo(e,t){t.replaceWith(e.cloneNode(!0))}leavingBardo(){}}function Cn(i){const e=Mt(document.documentElement),t={};for(const n of e){const{id:o}=n;for(const h of i.querySelectorAll("turbo-stream")){const g=It(h.templateElement.content,o);g&&(t[o]=[n,g])}}return t}async function In(i,e){const t=`turbo-stream-autofocus-${Z()}`,n=i.querySelectorAll("turbo-stream"),o=Fn(n);let h=null;if(o&&(o.id?h=o.id:h=t,o.id=h),e(),await ae(),(document.activeElement==null||document.activeElement==document.body)&&h){const S=document.getElementById(h);Ue(S)&&S.focus(),S&&S.id==t&&S.removeAttribute("id")}}async function Mn(i){const[e,t]=await Mr(i,()=>document.activeElement),n=e&&e.id;if(n){const o=document.getElementById(n);Ue(o)&&o!=t&&o.focus()}}function Fn(i){for(const e of i){const t=Et(e.templateElement.content);if(t)return t}return null}class Hn{sources=new Set;#e=!1;constructor(e){this.delegate=e}start(){this.#e||(this.#e=!0,addEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}stop(){this.#e&&(this.#e=!1,removeEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}connectStreamSource(e){this.streamSourceIsConnected(e)||(this.sources.add(e),e.addEventListener("message",this.receiveMessageEvent,!1))}disconnectStreamSource(e){this.streamSourceIsConnected(e)&&(this.sources.delete(e),e.removeEventListener("message",this.receiveMessageEvent,!1))}streamSourceIsConnected(e){return this.sources.has(e)}inspectFetchResponse=e=>{const t=On(e);t&&qn(t)&&(e.preventDefault(),this.receiveMessageResponse(t))};receiveMessageEvent=e=>{this.#e&&typeof e.data=="string"&&this.receiveMessageHTML(e.data)};async receiveMessageResponse(e){const t=await e.responseHTML;t&&this.receiveMessageHTML(t)}receiveMessageHTML(e){this.delegate.receivedMessageFromStream(he.wrap(e))}}function On(i){const e=i.detail?.fetchResponse;if(e instanceof We)return e}function qn(i){return(i.contentType??"").startsWith(he.contentType)}class at extends Ye{static renderElement(e,t){const{documentElement:n,body:o}=document;n.replaceChild(t,o)}async render(){this.replaceHeadAndBody(),this.activateScriptElements()}replaceHeadAndBody(){const{documentElement:e,head:t}=document;e.replaceChild(this.newHead,t),this.renderElement(this.currentElement,this.newElement)}activateScriptElements(){for(const e of this.scriptElements){const t=e.parentNode;if(t){const n=_e(e);t.replaceChild(n,e)}}}get newHead(){return this.newSnapshot.headSnapshot.element}get scriptElements(){return document.documentElement.querySelectorAll("script")}}var Bn=function(){let i=new Set,e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:s,afterNodeAdded:s,beforeNodeMorphed:s,afterNodeMorphed:s,beforeNodeRemoved:s,afterNodeRemoved:s,beforeAttributeUpdated:s},head:{style:"merge",shouldPreserve:function(u){return u.getAttribute("im-preserve")==="true"},shouldReAppend:function(u){return u.getAttribute("im-re-append")==="true"},shouldRemove:s,afterHeadMorphed:s}};function t(u,d,f={}){u instanceof Document&&(u=u.documentElement),typeof d=="string"&&(d=L(d));let y=q(d),w=c(u,y,f);return n(u,y,w)}function n(u,d,f){if(f.head.block){let y=u.querySelector("head"),w=d.querySelector("head");if(y&&w){let A=r(w,y,f);Promise.all(A).then(function(){n(u,d,Object.assign(f,{head:{block:!1,ignore:!0}}))});return}}if(f.morphStyle==="innerHTML")return g(d,u,f),u.children;if(f.morphStyle==="outerHTML"||f.morphStyle==null){let y=ne(d,u,f),w=y?.previousSibling,A=y?.nextSibling,T=h(u,y,f);return y?B(w,T,A):[]}else throw"Do not understand how to morph style "+f.morphStyle}function o(u,d){return d.ignoreActiveValue&&u===document.activeElement&&u!==document.body}function h(u,d,f){if(!(f.ignoreActive&&u===document.activeElement))return d==null?f.callbacks.beforeNodeRemoved(u)===!1?u:(u.remove(),f.callbacks.afterNodeRemoved(u),null):p(u,d)?(f.callbacks.beforeNodeMorphed(u,d)===!1||(u instanceof HTMLHeadElement&&f.head.ignore||(u instanceof HTMLHeadElement&&f.head.style!=="morph"?r(d,u,f):(_(d,u,f),o(u,f)||g(d,u,f))),f.callbacks.afterNodeMorphed(u,d)),u):f.callbacks.beforeNodeRemoved(u)===!1||f.callbacks.beforeNodeAdded(d)===!1?u:(u.parentElement.replaceChild(d,u),f.callbacks.afterNodeAdded(d),f.callbacks.afterNodeRemoved(u),d)}function g(u,d,f){let y=u.firstChild,w=d.firstChild,A;for(;y;){if(A=y,y=A.nextSibling,w==null){if(f.callbacks.beforeNodeAdded(A)===!1)return;d.appendChild(A),f.callbacks.afterNodeAdded(A),W(f,A);continue}if(m(A,w,f)){h(w,A,f),w=w.nextSibling,W(f,A);continue}let T=v(u,d,A,w,f);if(T){w=l(w,T,f),h(T,A,f),W(f,A);continue}let F=E(u,d,A,w,f);if(F){w=l(w,F,f),h(F,A,f),W(f,A);continue}if(f.callbacks.beforeNodeAdded(A)===!1)return;d.insertBefore(A,w),f.callbacks.afterNodeAdded(A),W(f,A)}for(;w!==null;){let T=w;w=w.nextSibling,P(T,f)}}function S(u,d,f,y){return u==="value"&&y.ignoreActiveValue&&d===document.activeElement?!0:y.callbacks.beforeAttributeUpdated(u,d,f)===!1}function _(u,d,f){let y=u.nodeType;if(y===1){const w=u.attributes,A=d.attributes;for(const T of w)S(T.name,d,"update",f)||d.getAttribute(T.name)!==T.value&&d.setAttribute(T.name,T.value);for(let T=A.length-1;0<=T;T--){const F=A[T];S(F.name,d,"remove",f)||u.hasAttribute(F.name)||d.removeAttribute(F.name)}}(y===8||y===3)&&d.nodeValue!==u.nodeValue&&(d.nodeValue=u.nodeValue),o(d,f)||R(u,d,f)}function b(u,d,f,y){if(u[f]!==d[f]){let w=S(f,d,"update",y);w||(d[f]=u[f]),u[f]?w||d.setAttribute(f,u[f]):S(f,d,"remove",y)||d.removeAttribute(f)}}function R(u,d,f){if(u instanceof HTMLInputElement&&d instanceof HTMLInputElement&&u.type!=="file"){let y=u.value,w=d.value;b(u,d,"checked",f),b(u,d,"disabled",f),u.hasAttribute("value")?y!==w&&(S("value",d,"update",f)||(d.setAttribute("value",y),d.value=y)):S("value",d,"remove",f)||(d.value="",d.removeAttribute("value"))}else if(u instanceof HTMLOptionElement)b(u,d,"selected",f);else if(u instanceof HTMLTextAreaElement&&d instanceof HTMLTextAreaElement){let y=u.value,w=d.value;if(S("value",d,"update",f))return;y!==w&&(d.value=y),d.firstChild&&d.firstChild.nodeValue!==y&&(d.firstChild.nodeValue=y)}}function r(u,d,f){let y=[],w=[],A=[],T=[],F=f.head.style,J=new Map;for(const H of u.children)J.set(H.outerHTML,H);for(const H of d.children){let $=J.has(H.outerHTML),me=f.head.shouldReAppend(H),Oe=f.head.shouldPreserve(H);$||Oe?me?w.push(H):(J.delete(H.outerHTML),A.push(H)):F==="append"?me&&(w.push(H),T.push(H)):f.head.shouldRemove(H)!==!1&&w.push(H)}T.push(...J.values());let et=[];for(const H of T){let $=document.createRange().createContextualFragment(H.outerHTML).firstChild;if(f.callbacks.beforeNodeAdded($)!==!1){if($.href||$.src){let me=null,Oe=new Promise(function(jt){me=jt});$.addEventListener("load",function(){me()}),et.push(Oe)}d.appendChild($),f.callbacks.afterNodeAdded($),y.push($)}}for(const H of w)f.callbacks.beforeNodeRemoved(H)!==!1&&(d.removeChild(H),f.callbacks.afterNodeRemoved(H));return f.head.afterHeadMorphed(d,{added:y,kept:A,removed:w}),et}function s(){}function a(u){let d={};return Object.assign(d,e),Object.assign(d,u),d.callbacks={},Object.assign(d.callbacks,e.callbacks),Object.assign(d.callbacks,u.callbacks),d.head={},Object.assign(d.head,e.head),Object.assign(d.head,u.head),d}function c(u,d,f){return f=a(f),{target:u,newContent:d,config:f,morphStyle:f.morphStyle,ignoreActive:f.ignoreActive,ignoreActiveValue:f.ignoreActiveValue,idMap:He(u,d),deadIds:new Set,callbacks:f.callbacks,head:f.head}}function m(u,d,f){return u==null||d==null?!1:u.nodeType===d.nodeType&&u.tagName===d.tagName?u.id!==""&&u.id===d.id?!0:X(f,u,d)>0:!1}function p(u,d){return u==null||d==null?!1:u.nodeType===d.nodeType&&u.tagName===d.tagName}function l(u,d,f){for(;u!==d;){let y=u;u=u.nextSibling,P(y,f)}return W(f,d),d.nextSibling}function v(u,d,f,y,w){let A=X(w,f,d),T=null;if(A>0){let F=y,J=0;for(;F!=null;){if(m(f,F,w))return F;if(J+=X(w,F,u),J>A)return null;F=F.nextSibling}}return T}function E(u,d,f,y,w){let A=y,T=f.nextSibling,F=0;for(;A!=null;){if(X(w,A,u)>0)return null;if(p(f,A))return A;if(p(T,A)&&(F++,T=T.nextSibling,F>=2))return null;A=A.nextSibling}return A}function L(u){let d=new DOMParser,f=u.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(f.match(/<\/html>/)||f.match(/<\/head>/)||f.match(/<\/body>/)){let y=d.parseFromString(u,"text/html");if(f.match(/<\/html>/))return y.generatedByIdiomorph=!0,y;{let w=y.firstChild;return w?(w.generatedByIdiomorph=!0,w):null}}else{let w=d.parseFromString("<body><template>"+u+"</template></body>","text/html").body.querySelector("template").content;return w.generatedByIdiomorph=!0,w}}function q(u){if(u==null)return document.createElement("div");if(u.generatedByIdiomorph)return u;if(u instanceof Node){const d=document.createElement("div");return d.append(u),d}else{const d=document.createElement("div");for(const f of[...u])d.append(f);return d}}function B(u,d,f){let y=[],w=[];for(;u!=null;)y.push(u),u=u.previousSibling;for(;y.length>0;){let A=y.pop();w.push(A),d.parentElement.insertBefore(A,d)}for(w.push(d);f!=null;)y.push(f),w.push(f),f=f.nextSibling;for(;y.length>0;)d.parentElement.insertBefore(y.pop(),d.nextSibling);return w}function ne(u,d,f){let y;y=u.firstChild;let w=y,A=0;for(;y;){let T=fe(y,d,f);T>A&&(w=y,A=T),y=y.nextSibling}return w}function fe(u,d,f){return p(u,d)?.5+X(f,u,d):0}function P(u,d){W(d,u),d.callbacks.beforeNodeRemoved(u)!==!1&&(u.remove(),d.callbacks.afterNodeRemoved(u))}function Se(u,d){return!u.deadIds.has(d)}function Ae(u,d,f){return(u.idMap.get(f)||i).has(d)}function W(u,d){let f=u.idMap.get(d)||i;for(const y of f)u.deadIds.add(y)}function X(u,d,f){let y=u.idMap.get(d)||i,w=0;for(const A of y)Se(u,A)&&Ae(u,A,f)&&++w;return w}function U(u,d){let f=u.parentElement,y=u.querySelectorAll("[id]");for(const w of y){let A=w;for(;A!==f&&A!=null;){let T=d.get(A);T==null&&(T=new Set,d.set(A,T)),T.add(w.id),A=A.parentElement}}}function He(u,d){let f=new Map;return U(u,f),U(d,f),f}return{morph:t,defaults:e}}();function je(i,e,{callbacks:t,...n}={}){Bn.morph(i,e,{...n,callbacks:new xn(t)})}function xt(i,e){je(i,e.children,{morphStyle:"innerHTML"})}class xn{#e;constructor({beforeNodeMorphed:e}={}){this.#e=e||(()=>!0)}beforeNodeAdded=e=>!(e.id&&e.hasAttribute("data-turbo-permanent")&&document.getElementById(e.id));beforeNodeMorphed=(e,t)=>{if(e instanceof Element)return!e.hasAttribute("data-turbo-permanent")&&this.#e(e,t)?!I("turbo:before-morph-element",{cancelable:!0,target:e,detail:{currentElement:e,newElement:t}}).defaultPrevented:!1};beforeAttributeUpdated=(e,t,n)=>!I("turbo:before-morph-attribute",{cancelable:!0,target:t,detail:{attributeName:e,mutationType:n}}).defaultPrevented;beforeNodeRemoved=e=>this.beforeNodeMorphed(e);afterNodeMorphed=(e,t)=>{e instanceof Element&&I("turbo:morph-element",{target:e,detail:{currentElement:e,newElement:t}})}}class Dn extends Ce{static renderElement(e,t){I("turbo:before-frame-morph",{target:e,detail:{currentElement:e,newElement:t}}),xt(e,t)}}class Qe extends Ye{static renderElement(e,t){document.body&&t instanceof HTMLBodyElement?document.body.replaceWith(t):document.documentElement.appendChild(t)}get shouldRender(){return this.newSnapshot.isVisitable&&this.trackedElementsAreIdentical}get reloadReason(){if(!this.newSnapshot.isVisitable)return{reason:"turbo_visit_control_is_reload"};if(!this.trackedElementsAreIdentical)return{reason:"tracked_element_mismatch"}}async prepareToRender(){this.#e(),await this.mergeHead()}async render(){this.willRender&&await this.replaceBody()}finishRendering(){super.finishRendering(),this.isPreview||this.focusFirstAutofocusableElement()}get currentHeadSnapshot(){return this.currentSnapshot.headSnapshot}get newHeadSnapshot(){return this.newSnapshot.headSnapshot}get newElement(){return this.newSnapshot.element}#e(){const{documentElement:e}=this.currentSnapshot,{lang:t}=this.newSnapshot;t?e.setAttribute("lang",t):e.removeAttribute("lang")}async mergeHead(){const e=this.mergeProvisionalElements(),t=this.copyNewHeadStylesheetElements();this.copyNewHeadScriptElements(),await e,await t,this.willRender&&this.removeUnusedDynamicStylesheetElements()}async replaceBody(){await this.preservingPermanentElements(async()=>{this.activateNewBody(),await this.assignNewBody()})}get trackedElementsAreIdentical(){return this.currentHeadSnapshot.trackedElementSignature==this.newHeadSnapshot.trackedElementSignature}async copyNewHeadStylesheetElements(){const e=[];for(const t of this.newHeadStylesheetElements)e.push(Pr(t)),document.head.appendChild(t);await Promise.all(e)}copyNewHeadScriptElements(){for(const e of this.newHeadScriptElements)document.head.appendChild(_e(e))}removeUnusedDynamicStylesheetElements(){for(const e of this.unusedDynamicStylesheetElements)document.head.removeChild(e)}async mergeProvisionalElements(){const e=[...this.newHeadProvisionalElements];for(const t of this.currentHeadProvisionalElements)this.isCurrentElementInElementList(t,e)||document.head.removeChild(t);for(const t of e)document.head.appendChild(t)}isCurrentElementInElementList(e,t){for(const[n,o]of t.entries()){if(e.tagName=="TITLE"){if(o.tagName!="TITLE")continue;if(e.innerHTML==o.innerHTML)return t.splice(n,1),!0}if(o.isEqualNode(e))return t.splice(n,1),!0}return!1}removeCurrentHeadProvisionalElements(){for(const e of this.currentHeadProvisionalElements)document.head.removeChild(e)}copyNewHeadProvisionalElements(){for(const e of this.newHeadProvisionalElements)document.head.appendChild(e)}activateNewBody(){document.adoptNode(this.newElement),this.activateNewBodyScriptElements()}activateNewBodyScriptElements(){for(const e of this.newBodyScriptElements){const t=_e(e);e.replaceWith(t)}}async assignNewBody(){await this.renderElement(this.currentElement,this.newElement)}get unusedDynamicStylesheetElements(){return this.oldHeadStylesheetElements.filter(e=>e.getAttribute("data-turbo-track")==="dynamic")}get oldHeadStylesheetElements(){return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)}get newHeadStylesheetElements(){return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)}get newHeadScriptElements(){return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)}get currentHeadProvisionalElements(){return this.currentHeadSnapshot.provisionalElements}get newHeadProvisionalElements(){return this.newHeadSnapshot.provisionalElements}get newBodyScriptElements(){return this.newElement.querySelectorAll("script")}}class Vn extends Qe{static renderElement(e,t){je(e,t,{callbacks:{beforeNodeMorphed:n=>!lt(n)}});for(const n of e.querySelectorAll("turbo-frame"))lt(n)&&Nn(n);I("turbo:morph",{detail:{currentElement:e,newElement:t}})}async preservingPermanentElements(e){return await e()}get renderMethod(){return"morph"}get shouldAutofocus(){return!1}}function lt(i){return i instanceof V&&i.src&&i.refresh==="morph"&&!i.closest("[data-turbo-permanent]")}function Nn(i){i.addEventListener("turbo:before-frame-render",({detail:e})=>{e.render=Dn.renderElement},{once:!0}),i.reload()}class Wn{keys=[];snapshots={};constructor(e){this.size=e}has(e){return Ee(e)in this.snapshots}get(e){if(this.has(e)){const t=this.read(e);return this.touch(e),t}}put(e,t){return this.write(e,t),this.touch(e),t}clear(){this.snapshots={}}read(e){return this.snapshots[Ee(e)]}write(e,t){this.snapshots[Ee(e)]=t}touch(e){const t=Ee(e),n=this.keys.indexOf(t);n>-1&&this.keys.splice(n,1),this.keys.unshift(t),this.trim()}trim(){for(const e of this.keys.splice(this.size))delete this.snapshots[e]}}class Un extends Ft{snapshotCache=new Wn(10);lastRenderedLocation=new URL(location.href);forceReloaded=!1;shouldTransitionTo(e){return this.snapshot.prefersViewTransitions&&e.prefersViewTransitions}renderPage(e,t=!1,n=!0,o){const g=this.isPageRefresh(o)&&this.snapshot.shouldMorphPage?Vn:Qe,S=new g(this.snapshot,e,g.renderElement,t,n);return S.shouldRender?o?.changeHistory():this.forceReloaded=!0,this.render(S)}renderError(e,t){t?.changeHistory();const n=new at(this.snapshot,e,at.renderElement,!1);return this.render(n)}clearSnapshotCache(){this.snapshotCache.clear()}async cacheSnapshot(e=this.snapshot){if(e.isCacheable){this.delegate.viewWillCacheSnapshot();const{lastRenderedLocation:t}=this;await _t();const n=e.clone();return this.snapshotCache.put(t,n),n}}getCachedSnapshotForLocation(e){return this.snapshotCache.get(e)}isPageRefresh(e){return!e||this.lastRenderedLocation.pathname===e.location.pathname&&e.action==="replace"}shouldPreserveScrollPosition(e){return this.isPageRefresh(e)&&this.snapshot.shouldPreserveScrollPosition}get snapshot(){return D.fromElement(this.element)}}class $n{selector="a[data-turbo-preload]";constructor(e,t){this.delegate=e,this.snapshotCache=t}start(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",this.#e):this.preloadOnLoadLinksForView(document.body)}stop(){document.removeEventListener("DOMContentLoaded",this.#e)}preloadOnLoadLinksForView(e){for(const t of e.querySelectorAll(this.selector))this.delegate.shouldPreloadLink(t)&&this.preloadURL(t)}async preloadURL(e){const t=new URL(e.href);if(this.snapshotCache.has(t))return;await new ye(this,x.get,t,new URLSearchParams,e).perform()}prepareRequest(e){e.headers["X-Sec-Purpose"]="prefetch"}async requestSucceededWithResponse(e,t){try{const n=await t.responseHTML,o=D.fromHTMLString(n);this.snapshotCache.put(e.url,o)}catch{}}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}#e=()=>{this.preloadOnLoadLinksForView(document.body)}}class Gn{constructor(e){this.session=e}clear(){this.session.clearCache()}resetCacheControl(){this.#e("")}exemptPageFromCache(){this.#e("no-cache")}exemptPageFromPreview(){this.#e("no-preview")}#e(e){Ir("turbo-cache-control",e)}}class Xn{navigator=new Ln(this);history=new bn(this);view=new Un(this,document.documentElement);adapter=new pn(this);pageObserver=new Rn(this);cacheObserver=new gn;linkPrefetchObserver=new _n(this,document);linkClickObserver=new Ot(this,window);formSubmitObserver=new Xe(this,document);scrollObserver=new kn(this);streamObserver=new Hn(this);formLinkClickObserver=new qt(this,document.documentElement);frameRedirector=new vn(this,document.documentElement);streamMessageRenderer=new Pn;cache=new Gn(this);drive=!0;enabled=!0;progressBarDelay=500;started=!1;formMode="on";#e=150;constructor(e){this.recentRequests=e,this.preloader=new $n(this,this.view.snapshotCache),this.debouncedRefresh=this.refresh,this.pageRefreshDebouncePeriod=this.pageRefreshDebouncePeriod}start(){this.started||(this.pageObserver.start(),this.cacheObserver.start(),this.linkPrefetchObserver.start(),this.formLinkClickObserver.start(),this.linkClickObserver.start(),this.formSubmitObserver.start(),this.scrollObserver.start(),this.streamObserver.start(),this.frameRedirector.start(),this.history.start(),this.preloader.start(),this.started=!0,this.enabled=!0)}disable(){this.enabled=!1}stop(){this.started&&(this.pageObserver.stop(),this.cacheObserver.stop(),this.linkPrefetchObserver.stop(),this.formLinkClickObserver.stop(),this.linkClickObserver.stop(),this.formSubmitObserver.stop(),this.scrollObserver.stop(),this.streamObserver.stop(),this.frameRedirector.stop(),this.history.stop(),this.preloader.stop(),this.started=!1)}registerAdapter(e){this.adapter=e}visit(e,t={}){const n=t.frame?document.getElementById(t.frame):null;if(n instanceof V){const o=t.action||te(n);n.delegate.proposeVisitIfNavigatedWithAction(n,o),n.src=e.toString()}else this.navigator.proposeVisit(O(e),t)}refresh(e,t){!(t&&this.recentRequests.has(t))&&!this.navigator.currentVisit&&this.visit(e,{action:"replace",shouldCacheSnapshot:!1})}connectStreamSource(e){this.streamObserver.connectStreamSource(e)}disconnectStreamSource(e){this.streamObserver.disconnectStreamSource(e)}renderStreamMessage(e){this.streamMessageRenderer.render(he.wrap(e))}clearCache(){this.view.clearSnapshotCache()}setProgressBarDelay(e){this.progressBarDelay=e}setFormMode(e){this.formMode=e}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}get pageRefreshDebouncePeriod(){return this.#e}set pageRefreshDebouncePeriod(e){this.refresh=Fr(this.debouncedRefresh.bind(this),e),this.#e=e}shouldPreloadLink(e){const t=e.hasAttribute("data-turbo-method"),n=e.hasAttribute("data-turbo-stream"),o=e.getAttribute("data-turbo-frame"),h=o=="_top"?null:document.getElementById(o)||le(e,"turbo-frame:not([disabled])");if(t||n||h instanceof V)return!1;{const g=new URL(e.href);return this.elementIsNavigatable(e)&&Q(g,this.snapshot.rootLocation)}}historyPoppedToLocationWithRestorationIdentifierAndDirection(e,t,n){this.enabled?this.navigator.startVisit(e,t,{action:"restore",historyChanged:!0,direction:n}):this.adapter.pageInvalidated({reason:"turbo_disabled"})}scrollPositionChanged(e){this.history.updateRestorationData({scrollPosition:e})}willSubmitFormLinkToLocation(e,t){return this.elementIsNavigatable(e)&&Q(t,this.snapshot.rootLocation)}submittedFormLinkToLocation(){}canPrefetchRequestToLocation(e,t){return this.elementIsNavigatable(e)&&Q(t,this.snapshot.rootLocation)}willFollowLinkToLocation(e,t,n){return this.elementIsNavigatable(e)&&Q(t,this.snapshot.rootLocation)&&this.applicationAllowsFollowingLinkToLocation(e,t,n)}followedLinkToLocation(e,t){const n=this.getActionForLink(e),o=e.hasAttribute("data-turbo-stream");this.visit(t.href,{action:n,acceptsStreamResponse:o})}allowsVisitingLocationWithAction(e,t){return this.locationWithActionIsSamePage(e,t)||this.applicationAllowsVisitingLocation(e)}visitProposedToLocation(e,t){ct(e),this.adapter.visitProposedToLocation(e,t)}visitStarted(e){e.acceptsStreamResponse||(ke(document.documentElement),this.view.markVisitDirection(e.direction)),ct(e.location),e.silent||this.notifyApplicationAfterVisitingLocation(e.location,e.action)}visitCompleted(e){this.view.unmarkVisitDirection(),Pe(document.documentElement),this.notifyApplicationAfterPageLoad(e.getTimingMetrics())}locationWithActionIsSamePage(e,t){return this.navigator.locationWithActionIsSamePage(e,t)}visitScrolledToSamePageLocation(e,t){this.notifyApplicationAfterVisitingSamePageLocation(e,t)}willSubmitForm(e,t){const n=Ne(e,t);return this.submissionIsNavigatable(e,t)&&Q(O(n),this.snapshot.rootLocation)}formSubmitted(e,t){this.navigator.submitForm(e,t)}pageBecameInteractive(){this.view.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()}pageLoaded(){this.history.assumeControlOfScrollRestoration()}pageWillUnload(){this.history.relinquishControlOfScrollRestoration()}receivedMessageFromStream(e){this.renderStreamMessage(e)}viewWillCacheSnapshot(){this.navigator.currentVisit?.silent||this.notifyApplicationBeforeCachingSnapshot()}allowsImmediateRender({element:e},t){const n=this.notifyApplicationBeforeRender(e,t),{defaultPrevented:o,detail:{render:h}}=n;return this.view.renderer&&h&&(this.view.renderer.renderElement=h),!o}viewRenderedSnapshot(e,t,n){this.view.lastRenderedLocation=this.history.location,this.notifyApplicationAfterRender(n)}preloadOnLoadLinksForView(e){this.preloader.preloadOnLoadLinksForView(e)}viewInvalidated(e){this.adapter.pageInvalidated(e)}frameLoaded(e){this.notifyApplicationAfterFrameLoad(e)}frameRendered(e,t){this.notifyApplicationAfterFrameRender(e,t)}applicationAllowsFollowingLinkToLocation(e,t,n){return!this.notifyApplicationAfterClickingLinkToLocation(e,t,n).defaultPrevented}applicationAllowsVisitingLocation(e){return!this.notifyApplicationBeforeVisitingLocation(e).defaultPrevented}notifyApplicationAfterClickingLinkToLocation(e,t,n){return I("turbo:click",{target:e,detail:{url:t.href,originalEvent:n},cancelable:!0})}notifyApplicationBeforeVisitingLocation(e){return I("turbo:before-visit",{detail:{url:e.href},cancelable:!0})}notifyApplicationAfterVisitingLocation(e,t){return I("turbo:visit",{detail:{url:e.href,action:t}})}notifyApplicationBeforeCachingSnapshot(){return I("turbo:before-cache")}notifyApplicationBeforeRender(e,t){return I("turbo:before-render",{detail:{newBody:e,...t},cancelable:!0})}notifyApplicationAfterRender(e){return I("turbo:render",{detail:{renderMethod:e}})}notifyApplicationAfterPageLoad(e={}){return I("turbo:load",{detail:{url:this.location.href,timing:e}})}notifyApplicationAfterVisitingSamePageLocation(e,t){dispatchEvent(new HashChangeEvent("hashchange",{oldURL:e.toString(),newURL:t.toString()}))}notifyApplicationAfterFrameLoad(e){return I("turbo:frame-load",{target:e})}notifyApplicationAfterFrameRender(e,t){return I("turbo:frame-render",{detail:{fetchResponse:e},target:t,cancelable:!0})}submissionIsNavigatable(e,t){if(this.formMode=="off")return!1;{const n=t?this.elementIsNavigatable(t):!0;return this.formMode=="optin"?n&&e.closest('[data-turbo="true"]')!=null:n&&this.elementIsNavigatable(e)}}elementIsNavigatable(e){const t=le(e,"[data-turbo]"),n=le(e,"turbo-frame");return this.drive||n?t?t.getAttribute("data-turbo")!="false":!0:t?t.getAttribute("data-turbo")=="true":!1}getActionForLink(e){return te(e)||"advance"}get snapshot(){return this.view.snapshot}}function ct(i){Object.defineProperties(i,Yn)}const Yn={absoluteURL:{get(){return this.toString()}}},C=new Xn(kt),{cache:jn,navigator:xe}=C;function Ze(){C.start()}function Qn(i){C.registerAdapter(i)}function Zn(i,e){C.visit(i,e)}function Dt(i){C.connectStreamSource(i)}function Vt(i){C.disconnectStreamSource(i)}function Jn(i){C.renderStreamMessage(i)}function zn(){console.warn("Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),C.clearCache()}function Kn(i){C.setProgressBarDelay(i)}function ei(i){we.confirmMethod=i}function ti(i){C.setFormMode(i)}var ri=Object.freeze({__proto__:null,navigator:xe,session:C,cache:jn,PageRenderer:Qe,PageSnapshot:D,FrameRenderer:Ce,fetch:Pt,start:Ze,registerAdapter:Qn,visit:Zn,connectStreamSource:Dt,disconnectStreamSource:Vt,renderStreamMessage:Jn,clearCache:zn,setProgressBarDelay:Kn,setConfirmMethod:ei,setFormMode:ti});class ni extends Error{}class ii{fetchResponseLoaded=e=>Promise.resolve();#e=null;#t=()=>{};#r=!1;#i=!1;#s=new Set;action=null;constructor(e){this.element=e,this.view=new zr(this,this.element),this.appearanceObserver=new xr(this,this.element),this.formLinkClickObserver=new qt(this,this.element),this.linkInterceptor=new Ht(this,this.element),this.restorationIdentifier=Z(),this.formSubmitObserver=new Xe(this,this.element)}connect(){this.#r||(this.#r=!0,this.loadingStyle==se.lazy?this.appearanceObserver.start():this.#n(),this.formLinkClickObserver.start(),this.linkInterceptor.start(),this.formSubmitObserver.start())}disconnect(){this.#r&&(this.#r=!1,this.appearanceObserver.stop(),this.formLinkClickObserver.stop(),this.linkInterceptor.stop(),this.formSubmitObserver.stop())}disabledChanged(){this.loadingStyle==se.eager&&this.#n()}sourceURLChanged(){this.#v("src")||(this.element.isConnected&&(this.complete=!1),(this.loadingStyle==se.eager||this.#i)&&this.#n())}sourceURLReloaded(){const{src:e}=this.element;return this.element.removeAttribute("complete"),this.element.src=null,this.element.src=e,this.element.loaded}loadingStyleChanged(){this.loadingStyle==se.lazy?this.appearanceObserver.start():(this.appearanceObserver.stop(),this.#n())}async#n(){this.enabled&&this.isActive&&!this.complete&&this.sourceURL&&(this.element.loaded=this.#l(O(this.sourceURL)),this.appearanceObserver.stop(),await this.element.loaded,this.#i=!0)}async loadResponse(e){(e.redirected||e.succeeded&&e.isHTML)&&(this.sourceURL=e.response.url);try{const t=await e.responseHTML;if(t){const n=yt(t);D.fromDocument(n).isVisitable?await this.#a(e,n):await this.#h(e)}}finally{this.fetchResponseLoaded=()=>Promise.resolve()}}elementAppearedInViewport(e){this.proposeVisitIfNavigatedWithAction(e,te(e)),this.#n()}willSubmitFormLinkToLocation(e){return this.#c(e)}submittedFormLinkToLocation(e,t,n){const o=this.#o(e);o&&n.setAttribute("data-turbo-frame",o.id)}shouldInterceptLinkClick(e,t,n){return this.#c(e)}linkClickIntercepted(e,t){this.#d(e,t)}willSubmitForm(e,t){return e.closest("turbo-frame")==this.element&&this.#c(e,t)}formSubmitted(e,t){this.formSubmission&&this.formSubmission.stop(),this.formSubmission=new we(this,e,t);const{fetchRequest:n}=this.formSubmission;this.prepareRequest(n),this.formSubmission.start()}prepareRequest(e){e.headers["Turbo-Frame"]=this.id,this.currentNavigationElement?.hasAttribute("data-turbo-stream")&&e.acceptResponseType(he.contentType)}requestStarted(e){ke(this.element)}requestPreventedHandlingResponse(e,t){this.#t()}async requestSucceededWithResponse(e,t){await this.loadResponse(t),this.#t()}async requestFailedWithResponse(e,t){await this.loadResponse(t),this.#t()}requestErrored(e,t){console.error(t),this.#t()}requestFinished(e){Pe(this.element)}formSubmissionStarted({formElement:e}){ke(e,this.#o(e))}formSubmissionSucceededWithResponse(e,t){const n=this.#o(e.formElement,e.submitter);n.delegate.proposeVisitIfNavigatedWithAction(n,te(e.submitter,e.formElement,n)),n.delegate.loadResponse(t),e.isSafe||C.clearCache()}formSubmissionFailedWithResponse(e,t){this.element.delegate.loadResponse(t),C.clearCache()}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished({formElement:e}){Pe(e,this.#o(e))}allowsImmediateRender({element:e},t){const n=I("turbo:before-frame-render",{target:this.element,detail:{newFrame:e,...t},cancelable:!0}),{defaultPrevented:o,detail:{render:h}}=n;return this.view.renderer&&h&&(this.view.renderer.renderElement=h),!o}viewRenderedSnapshot(e,t,n){}preloadOnLoadLinksForView(e){C.preloadOnLoadLinksForView(e)}viewInvalidated(){}willRenderFrame(e,t){this.previousFrameElement=e.cloneNode(!0)}visitCachedSnapshot=({element:e})=>{const t=e.querySelector("#"+this.element.id);t&&this.previousFrameElement&&t.replaceChildren(...this.previousFrameElement.children),delete this.previousFrameElement};async#a(e,t){const n=await this.extractForeignFrameElement(t.body);if(n){const o=new Me(n),h=new Ce(this,this.view.snapshot,o,Ce.renderElement,!1,!1);this.view.renderPromise&&await this.view.renderPromise,this.changeHistory(),await this.view.render(h),this.complete=!0,C.frameRendered(e,this.element),C.frameLoaded(this.element),await this.fetchResponseLoaded(e)}else this.#f(e)&&this.#m(e)}async#l(e){const t=new ye(this,x.get,e,new URLSearchParams,this.element);return this.#e?.cancel(),this.#e=t,new Promise(n=>{this.#t=()=>{this.#t=()=>{},this.#e=null,n()},t.perform()})}#d(e,t,n){const o=this.#o(e,n);o.delegate.proposeVisitIfNavigatedWithAction(o,te(n,e,o)),this.#_(e,()=>{o.src=t})}proposeVisitIfNavigatedWithAction(e,t=null){if(this.action=t,this.action){const n=D.fromElement(e).clone(),{visitCachedSnapshot:o}=e.delegate;e.delegate.fetchResponseLoaded=async h=>{if(e.src){const{statusCode:g,redirected:S}=h,_=await h.responseHTML,R={response:{statusCode:g,redirected:S,responseHTML:_},visitCachedSnapshot:o,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:n};this.action&&(R.action=this.action),C.visit(e.src,R)}}}}changeHistory(){if(this.action){const e=St(this.action);C.history.update(e,O(this.element.src||""),this.restorationIdentifier)}}async#h(e){console.warn(`The response (${e.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`),await this.#u(e.response)}#f(e){this.element.setAttribute("complete","");const t=e.response,n=async(h,g)=>{h instanceof Response?this.#u(h):C.visit(h,g)};return!I("turbo:frame-missing",{target:this.element,detail:{response:t,visit:n},cancelable:!0}).defaultPrevented}#m(e){this.view.missing(),this.#p(e)}#p(e){const t=`The response (${e.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;throw new ni(t)}async#u(e){const t=new We(e),n=await t.responseHTML,{location:o,redirected:h,statusCode:g}=t;return C.visit(o,{response:{redirected:h,statusCode:g,responseHTML:n}})}#o(e,t){const n=Re("data-turbo-frame",t,e)||this.element.getAttribute("target");return ut(n)??this.element}async extractForeignFrameElement(e){let t;const n=CSS.escape(this.id);try{if(t=dt(e.querySelector(`turbo-frame#${n}`),this.sourceURL),t)return t;if(t=dt(e.querySelector(`turbo-frame[src][recurse~=${n}]`),this.sourceURL),t)return await t.loaded,await this.extractForeignFrameElement(t)}catch(o){return console.error(o),new V}return null}#g(e,t){const n=Ne(e,t);return Q(O(n),this.rootLocation)}#c(e,t){const n=Re("data-turbo-frame",t,e)||this.element.getAttribute("target");if(e instanceof HTMLFormElement&&!this.#g(e,t)||!this.enabled||n=="_top")return!1;if(n){const o=ut(n);if(o)return!o.disabled}return!(!C.elementIsNavigatable(e)||t&&!C.elementIsNavigatable(t))}get id(){return this.element.id}get enabled(){return!this.element.disabled}get sourceURL(){if(this.element.src)return this.element.src}set sourceURL(e){this.#b("src",()=>{this.element.src=e??null})}get loadingStyle(){return this.element.loading}get isLoading(){return this.formSubmission!==void 0||this.#t()!==void 0}get complete(){return this.element.hasAttribute("complete")}set complete(e){e?this.element.setAttribute("complete",""):this.element.removeAttribute("complete")}get isActive(){return this.element.isActive&&this.#r}get rootLocation(){const t=this.element.ownerDocument.querySelector('meta[name="turbo-root"]')?.content??"/";return O(t)}#v(e){return this.#s.has(e)}#b(e,t){this.#s.add(e),t(),this.#s.delete(e)}#_(e,t){this.currentNavigationElement=e,t(),delete this.currentNavigationElement}}function ut(i){if(i!=null){const e=document.getElementById(i);if(e instanceof V)return e}}function dt(i,e){if(i){const t=i.getAttribute("src");if(t!=null&&e!=null&&_r(t,e))throw new Error(`Matching <turbo-frame id="${i.id}"> element has a source URL which references itself`);if(i.ownerDocument!==document&&(i=document.importNode(i,!0)),i instanceof V)return i.connectedCallback(),i.disconnectedCallback(),i}}const Nt={after(){this.targetElements.forEach(i=>i.parentElement?.insertBefore(this.templateContent,i.nextSibling))},append(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(i=>i.append(this.templateContent))},before(){this.targetElements.forEach(i=>i.parentElement?.insertBefore(this.templateContent,i))},prepend(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(i=>i.prepend(this.templateContent))},remove(){this.targetElements.forEach(i=>i.remove())},replace(){const i=this.getAttribute("method");this.targetElements.forEach(e=>{i==="morph"?je(e,this.templateContent):e.replaceWith(this.templateContent)})},update(){const i=this.getAttribute("method");this.targetElements.forEach(e=>{i==="morph"?xt(e,this.templateContent):(e.innerHTML="",e.append(this.templateContent))})},refresh(){C.refresh(this.baseURI,this.requestId)}};class Je extends HTMLElement{static async renderElement(e){await e.performAction()}async connectedCallback(){try{await this.render()}catch(e){console.error(e)}finally{this.disconnect()}}async render(){return this.renderPromise??=(async()=>{const e=this.beforeRenderEvent;this.dispatchEvent(e)&&(await ae(),await e.detail.render(this))})()}disconnect(){try{this.remove()}catch{}}removeDuplicateTargetChildren(){this.duplicateChildren.forEach(e=>e.remove())}get duplicateChildren(){const e=this.targetElements.flatMap(n=>[...n.children]).filter(n=>!!n.id),t=[...this.templateContent?.children||[]].filter(n=>!!n.id).map(n=>n.id);return e.filter(n=>t.includes(n.id))}get performAction(){if(this.action){const e=Nt[this.action];if(e)return e;this.#e("unknown action")}this.#e("action attribute is missing")}get targetElements(){if(this.target)return this.targetElementsById;if(this.targets)return this.targetElementsByQuery;this.#e("target or targets attribute is missing")}get templateContent(){return this.templateElement.content.cloneNode(!0)}get templateElement(){if(this.firstElementChild===null){const e=this.ownerDocument.createElement("template");return this.appendChild(e),e}else if(this.firstElementChild instanceof HTMLTemplateElement)return this.firstElementChild;this.#e("first child element must be a <template> element")}get action(){return this.getAttribute("action")}get target(){return this.getAttribute("target")}get targets(){return this.getAttribute("targets")}get requestId(){return this.getAttribute("request-id")}#e(e){throw new Error(`${this.description}: ${e}`)}get description(){return(this.outerHTML.match(/<[^>]+>/)??[])[0]??"<turbo-stream>"}get beforeRenderEvent(){return new CustomEvent("turbo:before-stream-render",{bubbles:!0,cancelable:!0,detail:{newStream:this,render:Je.renderElement}})}get targetElementsById(){const e=this.ownerDocument?.getElementById(this.target);return e!==null?[e]:[]}get targetElementsByQuery(){const e=this.ownerDocument?.querySelectorAll(this.targets);return e.length!==0?Array.prototype.slice.call(e):[]}}class si extends HTMLElement{streamSource=null;connectedCallback(){this.streamSource=this.src.match(/^ws{1,2}:/)?new WebSocket(this.src):new EventSource(this.src),Dt(this.streamSource)}disconnectedCallback(){this.streamSource&&(this.streamSource.close(),Vt(this.streamSource))}get src(){return this.getAttribute("src")||""}}V.delegateConstructor=ii;customElements.get("turbo-frame")===void 0&&customElements.define("turbo-frame",V);customElements.get("turbo-stream")===void 0&&customElements.define("turbo-stream",Je);customElements.get("turbo-stream-source")===void 0&&customElements.define("turbo-stream-source",si);(()=>{let i=document.currentScript;if(i&&!i.hasAttribute("data-turbo-suppress-warning"))for(i=i.parentElement;i;){if(i==document.body)return console.warn(wt`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your applicationâs JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ââ
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,i.outerHTML);i=i.parentElement}})();window.Turbo={...ri,StreamActions:Nt};Ze();function M(i){}addEventListener("turbo:click",M);addEventListener("turbo:before-visit",M);addEventListener("turbo:visit",M);addEventListener("turbo:before-cache",M);addEventListener("turbo:before-render",M);addEventListener("turbo:render",M);addEventListener("turbo:load",M);addEventListener("turbo:morph",M);addEventListener("turbo:before-morph-element",M);addEventListener("turbo:before-morph-attribute",M);addEventListener("turbo:morph-element",M);addEventListener("turbo:submit-start",M);addEventListener("turbo:submit-end",M);addEventListener("turbo:before-frame-render",M);addEventListener("turbo:frame-render",M);addEventListener("turbo:frame-load",M);addEventListener("turbo:frame-missing",M);addEventListener("turbo:before-stream-render",M);addEventListener("turbo:before-fetch-request",M);addEventListener("turbo:before-fetch-response",M);addEventListener("turbo:before-prefetch",M);addEventListener("turbo:fetch-request-error",M);let be;function Wt(i){be=i}window.addEventListener("beforeunload",()=>{const i=document.querySelector("main");i&&(re.refresh=i.scrollTop),localStorage.setItem("scrollTops",JSON.stringify(re))});const ht=localStorage.getItem("scrollTops"),re=ht?JSON.parse(ht):{};if(re.refresh){const i=re.refresh;delete re.refresh,Wt(i)}document.addEventListener("turbo:visit",i=>{switch(i.detail?.action){case"restore":{if(document.querySelector("main")){const t=xe.history.restorationIdentifier;Wt(re[t]??0)}break}case"advance":case"replace":{const e=document.querySelector("main");if(e){const t=xe.history.restorationIdentifier;re[t]=e.scrollTop}break}}});const ft=new ResizeObserver(()=>{if(!be)return;const i=document.querySelector("main");i&&i.scrollHeight>=be&&(Ut(i,be),be=void 0)});function Ut(i,e,t=0){t>20||(i.scrollTop=e,i.scrollTop!==e&&setTimeout(()=>Ut(i,e,t+1),10))}function $t(){ft.disconnect(),ft.observe(document.querySelector("main"))}addEventListener("turbo:load",$t);addEventListener("turbo:render",$t);Ze();var De=[],ue,Ie=0,ze=!1,Gt={logWriterApiUrl:"",logLevel:"ERROR",shimConsole:!1,autoFlush:!0,autoFlushOnClose:!0},N=Gt,mt={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},pe={trace:console.trace,debug:console.debug,log:console.log,warn:console.warn,error:console.error},oi={TRACE:pe.debug,DEBUG:pe.debug,INFO:pe.log,WARN:pe.warn,ERROR:pe.error};function ai(i){return JSON.stringify(i,(()=>{const t=new WeakSet;return(n,o)=>{if(typeof o=="object"&&o!==null){if(t.has(o))return"[[circular]]";t.add(o)}return o}})())}function li(i){return typeof i=="string"?i:typeof i>"u"?"undefined":i===null?"null":i instanceof Error?i.stack?i.stack:`${i}`:typeof i=="object"?ai(i):i.toString()}function Fe(i,e){N.properties=N.properties??{},N.properties[i]=e}function ci(i){ze=!0;const e=structuredClone(Gt);Object.assign(e,i),Object.assign(N,e),N.shimConsole&&gi(),N.autoFlushOnClose||vi()}function ui(i){return i===null?4:i===void 0?9:i===!0?4:i===!1?5:i.toString().length}function di(i){let e=0;return i.map(t=>ui(t)).forEach(t=>{e+=t}),e}function hi(i=1e3){ue&&clearTimeout(ue),ue=setTimeout(Ke,i)}async function Ke(){if(!ze)throw new Error("Logger not initialized");if(ue&&clearTimeout(ue),ue=void 0,Ie>0){const i=JSON.stringify(De);De.length=0,Ie=0,await fetch(`${N.logWriterApiUrl}/logs`,{method:"POST",body:i,headers:{"content-type":"application/json"}})}}function fi(i,e){if(!ze)throw new Error("Logger not initialized");if(mt[i]<mt[N.logLevel])return;const t={level:i,values:e,ts:Date.now()};N.properties&&(t.properties=structuredClone(N.properties)),De.push(t),Ie+=di(e),Ie>10240?Ke():hi()}function mi(i){if(i===null)return i;switch(typeof i){case"string":case"number":case"undefined":return i;default:return li(i)}}function ge(i,...e){oi[i]?.apply(this,[`[${i.toUpperCase()}]`,...e]);const t=e.map(mi);pi(i,t)}function pi(i,e){fi(i,e)}function gi(){console.trace=function(...i){ge("TRACE",...i)},console.debug=function(...i){ge("DEBUG",...i)},console.log=function(...i){ge("INFO",...i)},console.warn=function(...i){ge("WARN",...i)},console.error=function(...i){ge("ERROR",...i)}}function pt(){Ke()}function vi(){if(typeof window<"u"){window.addEventListener("beforeunload",pt);const{meta:i}=window.import;"hot"in i&&i.hot?.on("vite:beforeUpdate",pt)}}var ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xt={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(i){(function(){var e=function(){this.init()};e.prototype={init:function(){var r=this||t;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window<"u"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var s=this||t;if(r=parseFloat(r),s.ctx||R(),typeof r<"u"&&r>=0&&r<=1){if(s._volume=r,s._muted)return s;s.usingWebAudio&&s.masterGain.gain.setValueAtTime(r,t.ctx.currentTime);for(var a=0;a<s._howls.length;a++)if(!s._howls[a]._webAudio)for(var c=s._howls[a]._getSoundIds(),m=0;m<c.length;m++){var p=s._howls[a]._soundById(c[m]);p&&p._node&&(p._node.volume=p._volume*r)}return s}return s._volume},mute:function(r){var s=this||t;s.ctx||R(),s._muted=r,s.usingWebAudio&&s.masterGain.gain.setValueAtTime(r?0:s._volume,t.ctx.currentTime);for(var a=0;a<s._howls.length;a++)if(!s._howls[a]._webAudio)for(var c=s._howls[a]._getSoundIds(),m=0;m<c.length;m++){var p=s._howls[a]._soundById(c[m]);p&&p._node&&(p._node.muted=r?!0:p._muted)}return s},stop:function(){for(var r=this||t,s=0;s<r._howls.length;s++)r._howls[s].stop();return r},unload:function(){for(var r=this||t,s=r._howls.length-1;s>=0;s--)r._howls[s].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close<"u"&&(r.ctx.close(),r.ctx=null,R()),r},codecs:function(r){return(this||t)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||t;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio<"u")try{var s=new Audio;typeof s.oncanplaythrough>"u"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var s=new Audio;s.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||t,s=null;try{s=typeof Audio<"u"?new Audio:null}catch{return r}if(!s||typeof s.canPlayType!="function")return r;var a=s.canPlayType("audio/mpeg;").replace(/^no$/,""),c=r._navigator?r._navigator.userAgent:"",m=c.match(/OPR\/(\d+)/g),p=m&&parseInt(m[0].split("/")[1],10)<33,l=c.indexOf("Safari")!==-1&&c.indexOf("Chrome")===-1,v=c.match(/Version\/(.*?) /),E=l&&v&&parseInt(v[1],10)<15;return r._codecs={mp3:!!(!p&&(a||s.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!a,opus:!!s.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(s.canPlayType('audio/wav; codecs="1"')||s.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!s.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!s.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(s.canPlayType("audio/x-m4a;")||s.canPlayType("audio/m4a;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(s.canPlayType("audio/x-m4b;")||s.canPlayType("audio/m4b;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(s.canPlayType("audio/x-mp4;")||s.canPlayType("audio/mp4;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!E&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!E&&s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!s.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(s.canPlayType("audio/x-flac;")||s.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||t;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var s=function(a){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var c=new Audio;c._unlocked=!0,r._releaseHtml5Audio(c)}catch{r.noAudio=!0;break}for(var m=0;m<r._howls.length;m++)if(!r._howls[m]._webAudio)for(var p=r._howls[m]._getSoundIds(),l=0;l<p.length;l++){var v=r._howls[m]._soundById(p[l]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}r._autoResume();var E=r.ctx.createBufferSource();E.buffer=r._scratchBuffer,E.connect(r.ctx.destination),typeof E.start>"u"?E.noteOn(0):E.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),E.onended=function(){E.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",s,!0),document.removeEventListener("click",s,!0),document.removeEventListener("keydown",s,!0);for(var L=0;L<r._howls.length;L++)r._howls[L]._emit("unlock")}};return document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("click",s,!0),document.addEventListener("keydown",s,!0),r}},_obtainHtml5Audio:function(){var r=this||t;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var s=new Audio().play();return s&&typeof Promise<"u"&&(s instanceof Promise||typeof s.then=="function")&&s.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var s=this||t;return r._unlocked&&s._html5AudioPool.push(r),s},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend>"u"||!t.usingWebAudio)){for(var s=0;s<r._howls.length;s++)if(r._howls[s]._webAudio){for(var a=0;a<r._howls[s]._sounds.length;a++)if(!r._howls[s]._sounds[a]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(r.autoSuspend){r._suspendTimer=null,r.state="suspending";var c=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(c,c)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume>"u"||!t.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var s=0;s<r._howls.length;s++)r._howls[s]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var t=new e,n=function(r){var s=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}s.init(r)};n.prototype={init:function(r){var s=this;return t.ctx||R(),s._autoplay=r.autoplay||!1,s._format=typeof r.format!="string"?r.format:[r.format],s._html5=r.html5||!1,s._muted=r.mute||!1,s._loop=r.loop||!1,s._pool=r.pool||5,s._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,s._rate=r.rate||1,s._sprite=r.sprite||{},s._src=typeof r.src!="string"?r.src:[r.src],s._volume=r.volume!==void 0?r.volume:1,s._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},s._duration=0,s._state="unloaded",s._sounds=[],s._endTimers={},s._queue=[],s._playLock=!1,s._onend=r.onend?[{fn:r.onend}]:[],s._onfade=r.onfade?[{fn:r.onfade}]:[],s._onload=r.onload?[{fn:r.onload}]:[],s._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],s._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],s._onpause=r.onpause?[{fn:r.onpause}]:[],s._onplay=r.onplay?[{fn:r.onplay}]:[],s._onstop=r.onstop?[{fn:r.onstop}]:[],s._onmute=r.onmute?[{fn:r.onmute}]:[],s._onvolume=r.onvolume?[{fn:r.onvolume}]:[],s._onrate=r.onrate?[{fn:r.onrate}]:[],s._onseek=r.onseek?[{fn:r.onseek}]:[],s._onunlock=r.onunlock?[{fn:r.onunlock}]:[],s._onresume=[],s._webAudio=t.usingWebAudio&&!s._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(s),s._autoplay&&s._queue.push({event:"play",action:function(){s.play()}}),s._preload&&s._preload!=="none"&&s.load(),s},load:function(){var r=this,s=null;if(t.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var a=0;a<r._src.length;a++){var c,m;if(r._format&&r._format[a])c=r._format[a];else{if(m=r._src[a],typeof m!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}c=/^data:audio\/([^;,]+);/i.exec(m),c||(c=/\.([^.]+)$/.exec(m.split("?",1)[0])),c&&(c=c[1].toLowerCase())}if(c||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),c&&t.codecs(c)){s=r._src[a];break}}if(!s){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=s,r._state="loading",window.location.protocol==="https:"&&s.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new o(r),r._webAudio&&g(r),r},play:function(r,s){var a=this,c=null;if(typeof r=="number")c=r,r=null;else{if(typeof r=="string"&&a._state==="loaded"&&!a._sprite[r])return null;if(typeof r>"u"&&(r="__default",!a._playLock)){for(var m=0,p=0;p<a._sounds.length;p++)a._sounds[p]._paused&&!a._sounds[p]._ended&&(m++,c=a._sounds[p]._id);m===1?r=null:c=null}}var l=c?a._soundById(c):a._inactiveSound();if(!l)return null;if(c&&!r&&(r=l._sprite||"__default"),a._state!=="loaded"){l._sprite=r,l._ended=!1;var v=l._id;return a._queue.push({event:"play",action:function(){a.play(v)}}),v}if(c&&!l._paused)return s||a._loadQueue("play"),l._id;a._webAudio&&t._autoResume();var E=Math.max(0,l._seek>0?l._seek:a._sprite[r][0]/1e3),L=Math.max(0,(a._sprite[r][0]+a._sprite[r][1])/1e3-E),q=L*1e3/Math.abs(l._rate),B=a._sprite[r][0]/1e3,ne=(a._sprite[r][0]+a._sprite[r][1])/1e3;l._sprite=r,l._ended=!1;var fe=function(){l._paused=!1,l._seek=E,l._start=B,l._stop=ne,l._loop=!!(l._loop||a._sprite[r][2])};if(E>=ne){a._ended(l);return}var P=l._node;if(a._webAudio){var Se=function(){a._playLock=!1,fe(),a._refreshBuffer(l);var U=l._muted||a._muted?0:l._volume;P.gain.setValueAtTime(U,t.ctx.currentTime),l._playStart=t.ctx.currentTime,typeof P.bufferSource.start>"u"?l._loop?P.bufferSource.noteGrainOn(0,E,86400):P.bufferSource.noteGrainOn(0,E,L):l._loop?P.bufferSource.start(0,E,86400):P.bufferSource.start(0,E,L),q!==1/0&&(a._endTimers[l._id]=setTimeout(a._ended.bind(a,l),q)),s||setTimeout(function(){a._emit("play",l._id),a._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?Se():(a._playLock=!0,a.once("resume",Se),a._clearTimer(l._id))}else{var Ae=function(){P.currentTime=E,P.muted=l._muted||a._muted||t._muted||P.muted,P.volume=l._volume*t.volume(),P.playbackRate=l._rate;try{var U=P.play();if(U&&typeof Promise<"u"&&(U instanceof Promise||typeof U.then=="function")?(a._playLock=!0,fe(),U.then(function(){a._playLock=!1,P._unlocked=!0,s?a._loadQueue():a._emit("play",l._id)}).catch(function(){a._playLock=!1,a._emit("playerror",l._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),l._ended=!0,l._paused=!0})):s||(a._playLock=!1,fe(),a._emit("play",l._id)),P.playbackRate=l._rate,P.paused){a._emit("playerror",l._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||l._loop?a._endTimers[l._id]=setTimeout(a._ended.bind(a,l),q):(a._endTimers[l._id]=function(){a._ended(l),P.removeEventListener("ended",a._endTimers[l._id],!1)},P.addEventListener("ended",a._endTimers[l._id],!1))}catch(He){a._emit("playerror",l._id,He)}};P.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(P.src=a._src,P.load());var W=window&&window.ejecta||!P.readyState&&t._navigator.isCocoonJS;if(P.readyState>=3||W)Ae();else{a._playLock=!0,a._state="loading";var X=function(){a._state="loaded",Ae(),P.removeEventListener(t._canPlayEvent,X,!1)};P.addEventListener(t._canPlayEvent,X,!1),a._clearTimer(l._id)}}return l._id},pause:function(r){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"pause",action:function(){s.pause(r)}}),s;for(var a=s._getSoundIds(r),c=0;c<a.length;c++){s._clearTimer(a[c]);var m=s._soundById(a[c]);if(m&&!m._paused&&(m._seek=s.seek(a[c]),m._rateSeek=0,m._paused=!0,s._stopFade(a[c]),m._node))if(s._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),s._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||s._emit("pause",m?m._id:null)}return s},stop:function(r,s){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"stop",action:function(){a.stop(r)}}),a;for(var c=a._getSoundIds(r),m=0;m<c.length;m++){a._clearTimer(c[m]);var p=a._soundById(c[m]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=!0,p._ended=!0,a._stopFade(c[m]),p._node&&(a._webAudio?p._node.bufferSource&&(typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),a._cleanBuffer(p._node)):(!isNaN(p._node.duration)||p._node.duration===1/0)&&(p._node.currentTime=p._start||0,p._node.pause(),p._node.duration===1/0&&a._clearSound(p._node))),s||a._emit("stop",p._id))}return a},mute:function(r,s){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"mute",action:function(){a.mute(r,s)}}),a;if(typeof s>"u")if(typeof r=="boolean")a._muted=r;else return a._muted;for(var c=a._getSoundIds(s),m=0;m<c.length;m++){var p=a._soundById(c[m]);p&&(p._muted=r,p._interval&&a._stopFade(p._id),a._webAudio&&p._node?p._node.gain.setValueAtTime(r?0:p._volume,t.ctx.currentTime):p._node&&(p._node.muted=t._muted?!0:r),a._emit("mute",p._id))}return a},volume:function(){var r=this,s=arguments,a,c;if(s.length===0)return r._volume;if(s.length===1||s.length===2&&typeof s[1]>"u"){var m=r._getSoundIds(),p=m.indexOf(s[0]);p>=0?c=parseInt(s[0],10):a=parseFloat(s[0])}else s.length>=2&&(a=parseFloat(s[0]),c=parseInt(s[1],10));var l;if(typeof a<"u"&&a>=0&&a<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,s)}}),r;typeof c>"u"&&(r._volume=a),c=r._getSoundIds(c);for(var v=0;v<c.length;v++)l=r._soundById(c[v]),l&&(l._volume=a,s[2]||r._stopFade(c[v]),r._webAudio&&l._node&&!l._muted?l._node.gain.setValueAtTime(a,t.ctx.currentTime):l._node&&!l._muted&&(l._node.volume=a*t.volume()),r._emit("volume",l._id))}else return l=c?r._soundById(c):r._sounds[0],l?l._volume:0;return r},fade:function(r,s,a,c){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(r,s,a,c)}}),m;r=Math.min(Math.max(0,parseFloat(r)),1),s=Math.min(Math.max(0,parseFloat(s)),1),a=parseFloat(a),m.volume(r,c);for(var p=m._getSoundIds(c),l=0;l<p.length;l++){var v=m._soundById(p[l]);if(v){if(c||m._stopFade(p[l]),m._webAudio&&!v._muted){var E=t.ctx.currentTime,L=E+a/1e3;v._volume=r,v._node.gain.setValueAtTime(r,E),v._node.gain.linearRampToValueAtTime(s,L)}m._startFadeInterval(v,r,s,a,p[l],typeof c>"u")}}return m},_startFadeInterval:function(r,s,a,c,m,p){var l=this,v=s,E=a-s,L=Math.abs(E/.01),q=Math.max(4,L>0?c/L:c),B=Date.now();r._fadeTo=a,r._interval=setInterval(function(){var ne=(Date.now()-B)/c;B=Date.now(),v+=E*ne,v=Math.round(v*100)/100,E<0?v=Math.max(a,v):v=Math.min(a,v),l._webAudio?r._volume=v:l.volume(v,r._id,!0),p&&(l._volume=v),(a<s&&v<=a||a>s&&v>=a)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,l.volume(a,r._id),l._emit("fade",r._id))},q)},_stopFade:function(r){var s=this,a=s._soundById(r);return a&&a._interval&&(s._webAudio&&a._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(a._interval),a._interval=null,s.volume(a._fadeTo,r),a._fadeTo=null,s._emit("fade",r)),s},loop:function(){var r=this,s=arguments,a,c,m;if(s.length===0)return r._loop;if(s.length===1)if(typeof s[0]=="boolean")a=s[0],r._loop=a;else return m=r._soundById(parseInt(s[0],10)),m?m._loop:!1;else s.length===2&&(a=s[0],c=parseInt(s[1],10));for(var p=r._getSoundIds(c),l=0;l<p.length;l++)m=r._soundById(p[l]),m&&(m._loop=a,r._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=a,a&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,r.playing(p[l])&&(r.pause(p[l],!0),r.play(p[l],!0)))));return r},rate:function(){var r=this,s=arguments,a,c;if(s.length===0)c=r._sounds[0]._id;else if(s.length===1){var m=r._getSoundIds(),p=m.indexOf(s[0]);p>=0?c=parseInt(s[0],10):a=parseFloat(s[0])}else s.length===2&&(a=parseFloat(s[0]),c=parseInt(s[1],10));var l;if(typeof a=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,s)}}),r;typeof c>"u"&&(r._rate=a),c=r._getSoundIds(c);for(var v=0;v<c.length;v++)if(l=r._soundById(c[v]),l){r.playing(c[v])&&(l._rateSeek=r.seek(c[v]),l._playStart=r._webAudio?t.ctx.currentTime:l._playStart),l._rate=a,r._webAudio&&l._node&&l._node.bufferSource?l._node.bufferSource.playbackRate.setValueAtTime(a,t.ctx.currentTime):l._node&&(l._node.playbackRate=a);var E=r.seek(c[v]),L=(r._sprite[l._sprite][0]+r._sprite[l._sprite][1])/1e3-E,q=L*1e3/Math.abs(l._rate);(r._endTimers[c[v]]||!l._paused)&&(r._clearTimer(c[v]),r._endTimers[c[v]]=setTimeout(r._ended.bind(r,l),q)),r._emit("rate",l._id)}}else return l=r._soundById(c),l?l._rate:r._rate;return r},seek:function(){var r=this,s=arguments,a,c;if(s.length===0)r._sounds.length&&(c=r._sounds[0]._id);else if(s.length===1){var m=r._getSoundIds(),p=m.indexOf(s[0]);p>=0?c=parseInt(s[0],10):r._sounds.length&&(c=r._sounds[0]._id,a=parseFloat(s[0]))}else s.length===2&&(a=parseFloat(s[0]),c=parseInt(s[1],10));if(typeof c>"u")return 0;if(typeof a=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,s)}}),r;var l=r._soundById(c);if(l)if(typeof a=="number"&&a>=0){var v=r.playing(c);v&&r.pause(c,!0),l._seek=a,l._ended=!1,r._clearTimer(c),!r._webAudio&&l._node&&!isNaN(l._node.duration)&&(l._node.currentTime=a);var E=function(){v&&r.play(c,!0),r._emit("seek",c)};if(v&&!r._webAudio){var L=function(){r._playLock?setTimeout(L,0):E()};setTimeout(L,0)}else E()}else if(r._webAudio){var q=r.playing(c)?t.ctx.currentTime-l._playStart:0,B=l._rateSeek?l._rateSeek-l._seek:0;return l._seek+(B+q*Math.abs(l._rate))}else return l._node.currentTime;return r},playing:function(r){var s=this;if(typeof r=="number"){var a=s._soundById(r);return a?!a._paused:!1}for(var c=0;c<s._sounds.length;c++)if(!s._sounds[c]._paused)return!0;return!1},duration:function(r){var s=this,a=s._duration,c=s._soundById(r);return c&&(a=s._sprite[c._sprite][1]/1e3),a},state:function(){return this._state},unload:function(){for(var r=this,s=r._sounds,a=0;a<s.length;a++)s[a]._paused||r.stop(s[a]._id),r._webAudio||(r._clearSound(s[a]._node),s[a]._node.removeEventListener("error",s[a]._errorFn,!1),s[a]._node.removeEventListener(t._canPlayEvent,s[a]._loadFn,!1),s[a]._node.removeEventListener("ended",s[a]._endFn,!1),t._releaseHtml5Audio(s[a]._node)),delete s[a]._node,r._clearTimer(s[a]._id);var c=t._howls.indexOf(r);c>=0&&t._howls.splice(c,1);var m=!0;for(a=0;a<t._howls.length;a++)if(t._howls[a]._src===r._src||r._src.indexOf(t._howls[a]._src)>=0){m=!1;break}return h&&m&&delete h[r._src],t.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,s,a,c){var m=this,p=m["_on"+r];return typeof s=="function"&&p.push(c?{id:a,fn:s,once:c}:{id:a,fn:s}),m},off:function(r,s,a){var c=this,m=c["_on"+r],p=0;if(typeof s=="number"&&(a=s,s=null),s||a)for(p=0;p<m.length;p++){var l=a===m[p].id;if(s===m[p].fn&&l||!s&&l){m.splice(p,1);break}}else if(r)c["_on"+r]=[];else{var v=Object.keys(c);for(p=0;p<v.length;p++)v[p].indexOf("_on")===0&&Array.isArray(c[v[p]])&&(c[v[p]]=[])}return c},once:function(r,s,a){var c=this;return c.on(r,s,a,1),c},_emit:function(r,s,a){for(var c=this,m=c["_on"+r],p=m.length-1;p>=0;p--)(!m[p].id||m[p].id===s||r==="load")&&(setTimeout(function(l){l.call(this,s,a)}.bind(c,m[p].fn),0),m[p].once&&c.off(r,m[p].fn,m[p].id));return c._loadQueue(r),c},_loadQueue:function(r){var s=this;if(s._queue.length>0){var a=s._queue[0];a.event===r&&(s._queue.shift(),s._loadQueue()),r||a.action()}return s},_ended:function(r){var s=this,a=r._sprite;if(!s._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(s._ended.bind(s,r),100),s;var c=!!(r._loop||s._sprite[a][2]);if(s._emit("end",r._id),!s._webAudio&&c&&s.stop(r._id,!0).play(r._id),s._webAudio&&c){s._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=t.ctx.currentTime;var m=(r._stop-r._start)*1e3/Math.abs(r._rate);s._endTimers[r._id]=setTimeout(s._ended.bind(s,r),m)}return s._webAudio&&!c&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,s._clearTimer(r._id),s._cleanBuffer(r._node),t._autoSuspend()),!s._webAudio&&!c&&s.stop(r._id,!0),s},_clearTimer:function(r){var s=this;if(s._endTimers[r]){if(typeof s._endTimers[r]!="function")clearTimeout(s._endTimers[r]);else{var a=s._soundById(r);a&&a._node&&a._node.removeEventListener("ended",s._endTimers[r],!1)}delete s._endTimers[r]}return s},_soundById:function(r){for(var s=this,a=0;a<s._sounds.length;a++)if(r===s._sounds[a]._id)return s._sounds[a];return null},_inactiveSound:function(){var r=this;r._drain();for(var s=0;s<r._sounds.length;s++)if(r._sounds[s]._ended)return r._sounds[s].reset();return new o(r)},_drain:function(){var r=this,s=r._pool,a=0,c=0;if(!(r._sounds.length<s)){for(c=0;c<r._sounds.length;c++)r._sounds[c]._ended&&a++;for(c=r._sounds.length-1;c>=0;c--){if(a<=s)return;r._sounds[c]._ended&&(r._webAudio&&r._sounds[c]._node&&r._sounds[c]._node.disconnect(0),r._sounds.splice(c,1),a--)}}},_getSoundIds:function(r){var s=this;if(typeof r>"u"){for(var a=[],c=0;c<s._sounds.length;c++)a.push(s._sounds[c]._id);return a}else return[r]},_refreshBuffer:function(r){var s=this;return r._node.bufferSource=t.ctx.createBufferSource(),r._node.bufferSource.buffer=h[s._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,t.ctx.currentTime),s},_cleanBuffer:function(r){var s=this,a=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!r.bufferSource)return s;if(t._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),a))try{r.bufferSource.buffer=t._scratchBuffer}catch{}return r.bufferSource=null,s},_clearSound:function(r){var s=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);s||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(r){this._parent=r,this.init()};o.prototype={init:function(){var r=this,s=r._parent;return r._muted=s._muted,r._loop=s._loop,r._volume=s._volume,r._rate=s._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++t._counter,s._sounds.push(r),r.create(),r},create:function(){var r=this,s=r._parent,a=t._muted||r._muted||r._parent._muted?0:r._volume;return s._webAudio?(r._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),r._node.gain.setValueAtTime(a,t.ctx.currentTime),r._node.paused=!0,r._node.connect(t.masterGain)):t.noAudio||(r._node=t._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(t._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=s._src,r._node.preload=s._preload===!0?"auto":s._preload,r._node.volume=a*t.volume(),r._node.load()),r},reset:function(){var r=this,s=r._parent;return r._muted=s._muted,r._loop=s._loop,r._volume=s._volume,r._rate=s._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++t._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,s=r._parent;s._duration=Math.ceil(r._node.duration*10)/10,Object.keys(s._sprite).length===0&&(s._sprite={__default:[0,s._duration*1e3]}),s._state!=="loaded"&&(s._state="loaded",s._emit("load"),s._loadQueue()),r._node.removeEventListener(t._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,s=r._parent;s._duration===1/0&&(s._duration=Math.ceil(r._node.duration*10)/10,s._sprite.__default[1]===1/0&&(s._sprite.__default[1]=s._duration*1e3),s._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var h={},g=function(r){var s=r._src;if(h[s]){r._duration=h[s].duration,b(r);return}if(/^data:[^;]+;base64,/.test(s)){for(var a=atob(s.split(",")[1]),c=new Uint8Array(a.length),m=0;m<a.length;++m)c[m]=a.charCodeAt(m);_(c.buffer,r)}else{var p=new XMLHttpRequest;p.open(r._xhr.method,s,!0),p.withCredentials=r._xhr.withCredentials,p.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(l){p.setRequestHeader(l,r._xhr.headers[l])}),p.onload=function(){var l=(p.status+"")[0];if(l!=="0"&&l!=="2"&&l!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".");return}_(p.response,r)},p.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete h[s],r.load())},S(p)}},S=function(r){try{r.send()}catch{r.onerror()}},_=function(r,s){var a=function(){s._emit("loaderror",null,"Decoding audio data failed.")},c=function(m){m&&s._sounds.length>0?(h[s._src]=m,b(s,m)):a()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(r).then(c).catch(a):t.ctx.decodeAudioData(r,c,a)},b=function(r,s){s&&!r._duration&&(r._duration=s.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},R=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),s=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a=s?parseInt(s[1],10):null;if(r&&a&&a<9){var c=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!c&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};i.Howler=t,i.Howl=n,typeof ve<"u"?(ve.HowlerGlobal=e,ve.Howler=t,ve.Howl=n,ve.Sound=o):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=o)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var o=n._howls.length-1;o>=0;o--)n._howls[o].stereo(t);return n},HowlerGlobal.prototype.pos=function(t,n,o){var h=this;if(!h.ctx||!h.ctx.listener)return h;if(n=typeof n!="number"?h._pos[1]:n,o=typeof o!="number"?h._pos[2]:o,typeof t=="number")h._pos=[t,n,o],typeof h.ctx.listener.positionX<"u"?(h.ctx.listener.positionX.setTargetAtTime(h._pos[0],Howler.ctx.currentTime,.1),h.ctx.listener.positionY.setTargetAtTime(h._pos[1],Howler.ctx.currentTime,.1),h.ctx.listener.positionZ.setTargetAtTime(h._pos[2],Howler.ctx.currentTime,.1)):h.ctx.listener.setPosition(h._pos[0],h._pos[1],h._pos[2]);else return h._pos;return h},HowlerGlobal.prototype.orientation=function(t,n,o,h,g,S){var _=this;if(!_.ctx||!_.ctx.listener)return _;var b=_._orientation;if(n=typeof n!="number"?b[1]:n,o=typeof o!="number"?b[2]:o,h=typeof h!="number"?b[3]:h,g=typeof g!="number"?b[4]:g,S=typeof S!="number"?b[5]:S,typeof t=="number")_._orientation=[t,n,o,h,g,S],typeof _.ctx.listener.forwardX<"u"?(_.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),_.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),_.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),_.ctx.listener.upX.setTargetAtTime(h,Howler.ctx.currentTime,.1),_.ctx.listener.upY.setTargetAtTime(g,Howler.ctx.currentTime,.1),_.ctx.listener.upZ.setTargetAtTime(S,Howler.ctx.currentTime,.1)):_.ctx.listener.setOrientation(t,n,o,h,g,S);else return b;return _},Howl.prototype.init=function(t){return function(n){var o=this;return o._orientation=n.orientation||[1,0,0],o._stereo=n.stereo||null,o._pos=n.pos||null,o._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},o._onstereo=n.onstereo?[{fn:n.onstereo}]:[],o._onpos=n.onpos?[{fn:n.onpos}]:[],o._onorientation=n.onorientation?[{fn:n.onorientation}]:[],t.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"stereo",action:function(){o.stereo(t,n)}}),o;var h=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof t=="number")o._stereo=t,o._pos=[t,0,0];else return o._stereo;for(var g=o._getSoundIds(n),S=0;S<g.length;S++){var _=o._soundById(g[S]);if(_)if(typeof t=="number")_._stereo=t,_._pos=[t,0,0],_._node&&(_._pannerAttr.panningModel="equalpower",(!_._panner||!_._panner.pan)&&e(_,h),h==="spatial"?typeof _._panner.positionX<"u"?(_._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),_._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),_._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):_._panner.setPosition(t,0,0):_._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),o._emit("stereo",_._id);else return _._stereo}return o},Howl.prototype.pos=function(t,n,o,h){var g=this;if(!g._webAudio)return g;if(g._state!=="loaded")return g._queue.push({event:"pos",action:function(){g.pos(t,n,o,h)}}),g;if(n=typeof n!="number"?0:n,o=typeof o!="number"?-.5:o,typeof h>"u")if(typeof t=="number")g._pos=[t,n,o];else return g._pos;for(var S=g._getSoundIds(h),_=0;_<S.length;_++){var b=g._soundById(S[_]);if(b)if(typeof t=="number")b._pos=[t,n,o],b._node&&((!b._panner||b._panner.pan)&&e(b,"spatial"),typeof b._panner.positionX<"u"?(b._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),b._panner.positionZ.setValueAtTime(o,Howler.ctx.currentTime)):b._panner.setPosition(t,n,o)),g._emit("pos",b._id);else return b._pos}return g},Howl.prototype.orientation=function(t,n,o,h){var g=this;if(!g._webAudio)return g;if(g._state!=="loaded")return g._queue.push({event:"orientation",action:function(){g.orientation(t,n,o,h)}}),g;if(n=typeof n!="number"?g._orientation[1]:n,o=typeof o!="number"?g._orientation[2]:o,typeof h>"u")if(typeof t=="number")g._orientation=[t,n,o];else return g._orientation;for(var S=g._getSoundIds(h),_=0;_<S.length;_++){var b=g._soundById(S[_]);if(b)if(typeof t=="number")b._orientation=[t,n,o],b._node&&(b._panner||(b._pos||(b._pos=g._pos||[0,0,-.5]),e(b,"spatial")),typeof b._panner.orientationX<"u"?(b._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(o,Howler.ctx.currentTime)):b._panner.setOrientation(t,n,o)),g._emit("orientation",b._id);else return b._orientation}return g},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,o,h,g;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]=="object")o=n[0],typeof h>"u"&&(o.pannerAttr||(o.pannerAttr={coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor,panningModel:o.panningModel}),t._pannerAttr={coneInnerAngle:typeof o.pannerAttr.coneInnerAngle<"u"?o.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof o.pannerAttr.coneOuterAngle<"u"?o.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof o.pannerAttr.coneOuterGain<"u"?o.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof o.pannerAttr.distanceModel<"u"?o.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof o.pannerAttr.maxDistance<"u"?o.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof o.pannerAttr.refDistance<"u"?o.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof o.pannerAttr.rolloffFactor<"u"?o.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof o.pannerAttr.panningModel<"u"?o.pannerAttr.panningModel:t._panningModel});else return g=t._soundById(parseInt(n[0],10)),g?g._pannerAttr:t._pannerAttr;else n.length===2&&(o=n[0],h=parseInt(n[1],10));for(var S=t._getSoundIds(h),_=0;_<S.length;_++)if(g=t._soundById(S[_]),g){var b=g._pannerAttr;b={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:b.coneInnerAngle,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:b.coneOuterAngle,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:b.coneOuterGain,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:b.distanceModel,maxDistance:typeof o.maxDistance<"u"?o.maxDistance:b.maxDistance,refDistance:typeof o.refDistance<"u"?o.refDistance:b.refDistance,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:b.rolloffFactor,panningModel:typeof o.panningModel<"u"?o.panningModel:b.panningModel};var R=g._panner;R||(g._pos||(g._pos=t._pos||[0,0,-.5]),e(g,"spatial"),R=g._panner),R.coneInnerAngle=b.coneInnerAngle,R.coneOuterAngle=b.coneOuterAngle,R.coneOuterGain=b.coneOuterGain,R.distanceModel=b.distanceModel,R.maxDistance=b.maxDistance,R.refDistance=b.refDistance,R.rolloffFactor=b.rolloffFactor,R.panningModel=b.panningModel}return t},Sound.prototype.init=function(t){return function(){var n=this,o=n._parent;n._orientation=o._orientation,n._stereo=o._stereo,n._pos=o._pos,n._pannerAttr=o._pannerAttr,t.call(this),n._stereo?o.stereo(n._stereo):n._pos&&o.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var n=this,o=n._parent;return n._orientation=o._orientation,n._stereo=o._stereo,n._pos=o._pos,n._pannerAttr=o._pannerAttr,n._stereo?o.stereo(n._stereo):n._pos?o.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,o._refreshBuffer(n)),t.call(this)}}(Sound.prototype.reset);var e=function(t,n){n=n||"spatial",n==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(Xt);const[k,gt]=lr();function bi(i){let e=!1,t,n,o;async function h(l){const v=l.type;switch(v){case"LIBRARY":{const E=new dr({trackId:l.trackId.toString()}),L=hr(),q=L.clientId,B=Y.signatureToken();return L.clientId&&B&&(E.set("clientId",q),E.set("signature",B)),L.staticToken&&E.set("authorization",L.staticToken),it().format!==Y.AudioFormat.SOURCE&&E.set("format",it().format),`${L.apiUrl}/files/track?${E}`}default:return await ur.getTrackUrlForSource(l.id,v,Y.TrackAudioQuality.Low)}}function g(){const l=k()?.seek();if(typeof l=="number"){const v=Math.round(l);tt()!==v&&(console.debug(`Setting currentSeek to ${v}`),zt(v))}}async function S(){if(!k()){if(typeof qe()>"u")return console.debug("No track to play"),!1;const l=Kt()[qe()];if(!l)return console.debug("Not a valid track at playlist position",qe()),!1;console.debug("Setting track to",l);let v;const E=l.type;switch(E){case"LIBRARY":{const B=l.format;switch(B){case Y.AudioFormat.AAC:v="m4a";break;case Y.AudioFormat.FLAC:v="flac";break;case Y.AudioFormat.MP3:v="mp3";break;case Y.AudioFormat.OPUS:v="opus";break;case Y.AudioFormat.SOURCE:break;default:throw new Error(`Invalid track format '${B}'`)}break}case"TIDAL":case"QOBUZ":case"YT":v="source";break;default:throw new Error(`Invalid track type '${E}'`)}const L=new Xt.Howl({src:[await h(l)],format:v,html5:!0});L.volume(nt.currentPlaybackSession?.volume??1),L.pannerAttr({panningModel:"equalpower"}),gt(L);const q=Math.round(l.duration);!isNaN(q)&&isFinite(q)&&rt(q)}return!0}let _=!0,b=!1;async function R(){const l=k()?void 0:tt();if(!k()||_){if(!await S())return!1;k().on("end",n=v=>{if(_){console.debug("End called after track already ended",v,k(),k()?.duration());return}console.debug("Track ended",v,k(),k()?.duration()),_=!0,b=!1,c(),er()}),k().on("load",o=(...v)=>{_=!1,b=!0,console.debug("Track loaded",k(),k().duration(),...v);const E=Math.round(k().duration());!isNaN(E)&&isFinite(E)&&rt(E),typeof l=="number"&&(console.debug(`Setting initial seek to ${l}`),k().seek(l))})}return k().play(),t=setInterval(()=>{b&&g()},200),b&&typeof l=="number"&&(console.debug(`Setting initial seek to ${l}`),k().seek(l)),console.debug("Playing",k()),!0}function r(l){return console.debug("Track seeked",l),k()?.seek(l),!0}function s(){return k()?.pause(),clearInterval(t),console.debug("Paused"),!0}function a(){e=!1,k()?.off("end",n),k()?.off("load",o),_||k()?.stop(),b=!1,k()?.unload(),gt(void 0)}function c(){return a(),clearInterval(t),console.debug("Track stopped"),!0}const m=()=>{nt.audioZones.forEach(l=>{Qt(l)&&Zt()&&Jt()})};return{id:i,updatePlayback(l){for(const[v,E]of cr(l,["stop","volume","seek","play","tracks","position","playing","quality"]))if(!(typeof E>"u"))switch(v){case"stop":c();break;case"volume":k()?.volume(E);break;case"seek":if(!l.play)continue;r(E);break;case"playing":E?!e&&!l.play&&(R(),e=!0):e&&(s(),e=!1);break;case"play":if(Object.keys(l).every(L=>["sessionId","play","playing","seek"].includes(L))&&typeof l.seek=="number"&&k()){e||k().play();return}k()&&c(),R(),e=!0;break}},activate(){window.addEventListener("beforeunload",m)},deactivate(){window.removeEventListener("beforeunload",m),k()&&(console.debug("stopping howl"),a())}}}ci({logWriterApiUrl:"https://logs.moosicbox.com",shimConsole:!0,logLevel:"WARN"});Fe("connectionId",Le.get());Fe("connectionName",Ve.get());function _i(){sr.connection?.players.filter(i=>i.audioOutputId==="HOWLER").forEach(i=>{or(bi(i.playerId))})}tr(i=>{i.type===rr.CONNECTIONS&&_i()});function Yt(i,e){ar.registerConnection({connectionId:i,name:e,players:[{audioOutputId:"HOWLER",name:"Web Player"}]})}nr(()=>{Yt(Le.get(),Ve.get()),Fe("connectionId",Le.get())});Ve.listen(i=>{Yt(Le.get(),i),Fe("connectionName",i)});ir();
//# sourceMappingURL=hoisted.BNADhfBN.js.map
