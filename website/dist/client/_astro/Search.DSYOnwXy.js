import{d as se,c as u,h as fe,g as $,a as F,i as r,b as h,r as P,F as ae,S as M,t as f,l as ge,n as _e,x as ve,f as k,u as H,s as me,k as Se,w as R}from"./web.o2PnP_jd.js";import{d as ye}from"./index.B1IFpGVk.js";import{o as Ie,a as xe}from"./api.DZqBGp_p.js";import{e as Z,f as Y,g as z,c as te,a as Re}from"./Album.B7ZnFso0.js";/* empty css                        */import"./ChangePlaybackTargetModal.BU1Vz2Zf.js";var Ae=f("<div class=moosicbox-tabs><div class=moosicbox-tabs-headers></div><!$><!/>"),Le=f("<button type=button class=moosicbox-tabs-headers-header>"),Te=f("<div class=moosicbox-tabs-content><div>");function we(_){const[A,L]=u(_.default),[N,C]=u([]);return fe(()=>{L(_.default),C(Object.entries(_.tabs).map(([v,m])=>({key:v,display:m})))}),(()=>{var v=$(Ae),m=v.firstChild,q=m.nextSibling,[O,K]=F(q.nextSibling);return r(m,h(ae,{get each(){return N()},children:S=>(()=>{var p=$(Le);return p.$$click=()=>L(S.key),r(p,()=>S.display),P(),p})()})),r(v,h(M,{get when(){return A()},children:S=>(()=>{var p=$(Te),E=p.firstChild;return E.$$click=V=>V.stopPropagation(),r(E,()=>_.children(S())),P(),p})()}),O,K),v})()}se(["click"]);var ke=f("<div class=search-results-result><div class=search-results-result-icon></div><div class=search-results-result-details><span class=search-results-result-details-type>Artist</span> <span class=search-results-result-details-stop-word>-</span> <a class=search-results-result-details-artist tabindex=-1>"),Be=f("<div class=search-results-result><div class=search-results-result-icon></div><div class=search-results-result-details><span class=search-results-result-details-type>Album</span> <span class=search-results-result-details-stop-word>-</span> <a class=search-results-result-details-album tabindex=-1></a> <span class=search-results-result-details-stop-word>by</span> <a class=search-results-result-details-artist tabindex=-1>"),Ye=f("<div class=search-results-result><div class=search-results-result-icon></div><div class=search-results-result-details><span class=search-results-result-details-type>Track</span> <span class=search-results-result-details-stop-word>-</span> <a class=search-results-result-details-track tabindex=-1></a> <span class=search-results-result-details-stop-word>on</span> <a class=search-results-result-details-album tabindex=-1></a> <span class=search-results-result-details-stop-word>by</span> <a class=search-results-result-details-artist tabindex=-1>"),Ce=f("<div><!$><!/><!$><!/><!$><!/>"),Oe=f("<a class=search-results-result-link>"),Ee=f("<div data-turbo-permanent id=search-bar class=search-container><div class=search-label-container><label class=search-label><input class=search-input title=Search... type=text><div class=search-backdrop></div></label><img src=/img/cross.svg class=cancel-search-icon></div><div class=search-results>");function Me(){let _,A,L;const[N,C]=u(!1),[v,m]=u(!1),[q,O]=u(!1),[K,S]=u(!1),[p,E]=u(""),[V,le]=u(),[re,ie]=u(),[ne,ce]=u(),[de,ue]=u();function j(){A.focus(),A.blur()}function oe(t){t.target.select()}ge(()=>{}),_e(()=>{});function be(t,e){switch(t){case"LIBRARY":return{...e,type:"LIBRARY",artistId:e.artistId};case"TIDAL":return{...e,type:"TIDAL",id:e.artistId};case"QOBUZ":return{...e,type:"QOBUZ",id:e.artistId};case"YT":return{...e,type:"YT",id:e.artistId};default:throw new Error(`Invalid ApiSource: "${t}"`)}}function W(t,e){switch(t){case"LIBRARY":return{...e,type:"LIBRARY",artistId:e.artistId,albumId:e.albumId,versions:[]};case"TIDAL":return{...e,type:"TIDAL",artistId:e.artistId,id:e.albumId,explicit:!1,numberOfTracks:0,audioQuality:"LOSSLESS",mediaMetadataTags:[]};case"QOBUZ":return{...e,type:"QOBUZ",artistId:e.artistId,id:e.albumId,parentalWarning:!1,numberOfTracks:0};case"YT":return{...e,type:"YT",artistId:e.artistId,id:e.albumId,numberOfTracks:0};default:throw new Error(`Invalid ApiSource: "${t}"`)}}async function he(t){if(E(t),!!t.trim()){L.scroll({top:0,behavior:"instant"});try{C(!0),m(!0),O(!0),S(!0),Ie("search",async e=>{await xe.searchAll(t,0,20,(s,l,n)=>{switch(n){case"LIBRARY":le(s),C(!1);break;case"QOBUZ":ie(s),m(!1);break;case"TIDAL":ce(s),O(!1);break;case"YT":ue(s),S(!1);break;default:console.log(`received ${n} results:`,s)}},e)})}catch(e){console.error("Failed to run global search",e)}}}function pe(t,e){const s=e.type;switch(s){case"ARTIST":return z({id:e.artistId,type:t});case"ALBUM":return Y({id:e.albumId,type:t});case"TRACK":return Y({id:e.albumId,type:t});default:throw new Error(`Invalid result type: ${s}`)}}function $e(t,e){switch(e.type){case"ARTIST":{const s=e,l=be(t,s);return(()=>{var n=$(ke),i=n.firstChild,o=i.nextSibling,b=o.firstChild,d=b.nextSibling,a=d.nextSibling,y=a.nextSibling,c=y.nextSibling;return r(i,h(Re,{size:50,artist:l,route:!1})),r(c,()=>s.title),k(()=>R(c,"href",z({id:s.artistId,type:t}))),n})()}case"ALBUM":{const s=e,l=W(t,s);return(()=>{var n=$(Be),i=n.firstChild,o=i.nextSibling,b=o.firstChild,d=b.nextSibling,a=d.nextSibling,y=a.nextSibling,c=y.nextSibling,B=c.nextSibling,T=B.nextSibling,g=T.nextSibling,w=g.nextSibling;return r(i,h(te,{size:50,artist:!1,year:!1,route:!1,album:l})),r(c,()=>s.title),r(w,()=>s.artist),k(I=>{var U=Y({id:s.albumId,type:t}),D=z({id:s.artistId,type:t});return U!==I.e&&R(c,"href",I.e=U),D!==I.t&&R(w,"href",I.t=D),I},{e:void 0,t:void 0}),n})()}case"TRACK":{const s=e,l=W(t,s);return(()=>{var n=$(Ye),i=n.firstChild,o=i.nextSibling,b=o.firstChild,d=b.nextSibling,a=d.nextSibling,y=a.nextSibling,c=y.nextSibling,B=c.nextSibling,T=B.nextSibling,g=T.nextSibling,w=g.nextSibling,I=w.nextSibling,U=I.nextSibling,D=U.nextSibling,G=D.nextSibling;return r(i,h(te,{size:50,artist:!1,year:!1,route:!1,album:l})),r(c,()=>s.title),r(w,()=>s.album),r(G,()=>s.artist),k(x=>{var J=Y({id:s.albumId,type:t}),X=Y({id:s.albumId,type:t}),ee=z({id:s.artistId,type:t});return J!==x.e&&R(c,"href",x.e=J),X!==x.t&&R(w,"href",x.t=X),ee!==x.a&&R(G,"href",x.a=ee),x},{e:void 0,t:void 0,a:void 0}),n})()}}}function Q(t,e,s){return(()=>{var l=$(Ce),n=l.firstChild,[i,o]=F(n.nextSibling),b=i.nextSibling,[d,a]=F(b.nextSibling),y=d.nextSibling,[c,B]=F(y.nextSibling);return Se(l,`search-results-list${e?" loading":" loaded"}`),r(l,h(M,{get when(){return s?.length===0},children:"No results"}),i,o),r(l,h(M,{get when(){return(s?.length??0)!==0},get children(){return h(ae,{each:s,children:T=>(()=>{var g=$(Oe);return g.$$click=()=>j(),r(g,()=>$e(t,T)),k(()=>R(g,"href",pe(t,T))),P(),g})()})}}),d,a),r(l,h(M,{when:e,children:"Loading..."}),c,B),l})()}return(()=>{var t=$(Ee),e=t.firstChild,s=e.firstChild,l=s.firstChild,n=s.nextSibling,i=e.nextSibling,o=_;typeof o=="function"?H(o,t):_=t,l.$$keyup=a=>a.key==="Escape"&&j(),ve(l,"input",ye(async a=>{await he(a.target.value??"")},200)),l.addEventListener("focus",a=>oe(a));var b=A;typeof b=="function"?H(b,l):A=l,n.$$click=a=>{a.stopPropagation(),j()};var d=L;return typeof d=="function"?H(d,i):L=i,r(i,h(we,{default:"LIBRARY",get tabs(){return{LIBRARY:Z("LIBRARY"),QOBUZ:Z("QOBUZ"),TIDAL:Z("TIDAL"),YT:Z("YT")}},children:a=>{switch(a){case"LIBRARY":return Q("LIBRARY",N(),V());case"QOBUZ":return Q("QOBUZ",v(),re());case"TIDAL":return Q("TIDAL",q(),ne());case"YT":return Q("YT",K(),de());default:throw new Error(`Invalid tab: ${a}`)}}})),k(a=>(a=p()?.trim()?void 0:"none")!=null?i.style.setProperty("display",a):i.style.removeProperty("display")),k(()=>me(l,"value",p())),P(),t})()}se(["click","input","keyup"]);export{Me as default};
//# sourceMappingURL=Search.DSYOnwXy.js.map
