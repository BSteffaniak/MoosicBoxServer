import{d as Zt,c as g,j as X,o as Y,g as T,a as st,i as y,b as Z,e as vt,f as gt,w as et,r as xt,k as we,F as He,t as C,l as yt,n as nt,u as F,h as _e,S as We}from"./web.o2PnP_jd.js";/* empty css                        */import{p as k,b as Qe,r as je,e as Xt,f as Ze,g as Xe,h as $t,o as Ye,i as Ge,j as Se,k as Pe,l as Yt,m as Ue,n as Je,q as Ke,t as ti,u as ei,v as fe,w as pe,x as he,y as ii,z as li}from"./ChangePlaybackTargetModal.BU1Vz2Zf.js";import{c as xe,t as Wt,f as $e,g as si}from"./Album.B7ZnFso0.js";import{t as I,a as ni,c as Mt}from"./api.DZqBGp_p.js";var ai=C("<div class=playlist><div class=playlist-tracks><div class=playlist-tracks-play-queue>Play queue</div><!$><!/>"),oi=C("<div><div class=playlist-tracks-track-album-artwork><div class=playlist-tracks-track-album-artwork-icon><!$><!/><!$><!/></div></div><div class=playlist-tracks-track-details><div class=playlist-tracks-track-details-title></div><div class=playlist-tracks-track-details-artist></div></div><!$><!/>"),ri=C("<div class=playlist-tracks-playing-from>Playing from: <a>"),ci=C("<div class=playlist-tracks-next-up>Next up:"),ui=C("<img class=audio-icon src=/img/audio-white.svg alt=Playing>"),di=C("<img class=play-icon src=/img/play-button-white.svg alt=Playing>"),vi=C('<div class=playlist-tracks-track-remove><img class=cross-icon src=/img/cross-white.svg alt="Remove from queue">');function yi(){const[e,i]=g([]),[a,v]=g();function L(){v(e().findIndex(c=>I(c)===I(k.currentTrack)))}return X(Y(()=>Ze(),c=>{i(c),L()})),X(Y(()=>k.currentTrack,()=>{L()})),(()=>{var c=T(ai),P=c.firstChild,H=P.firstChild,V=H.nextSibling,[E,W]=st(V.nextSibling);return y(P,Z(He,{get each(){return e()},children:(m,p)=>[vt(()=>vt(()=>I(k.currentTrack)===I(m))()&&(()=>{var o=T(ri),l=o.firstChild,h=l.nextSibling;return y(h,()=>m.album),gt(()=>et(h,"href",`/albums/${m.albumId}`)),o})()),vt(()=>vt(()=>p()===(a()??0)+1)()&&T(ci)),(()=>{var o=T(oi),l=o.firstChild,h=l.firstChild,M=h.firstChild,[O,A]=st(M.nextSibling),z=O.nextSibling,[R,N]=st(z.nextSibling),$=l.nextSibling,w=$.firstChild,_=w.nextSibling,x=$.nextSibling,[at,ot]=st(x.nextSibling);return o.$$click=()=>p()!==a()&&Qe(p()),y(h,Z(xe,{album:m,size:50,route:!1}),O,A),y(h,(()=>{var f=vt(()=>p()===a());return()=>f()?T(ui):T(di)})(),R,N),y(w,()=>m.title),y(_,()=>m.artist),y(o,(()=>{var f=vt(()=>p()!==(a()??0));return()=>f()&&(()=>{var G=T(vi);return G.$$click=U=>{je(p()),U.stopImmediatePropagation()},xt(),G})()})(),at,ot),gt(()=>we(o,`playlist-tracks-track${I(k.currentTrack)===I(m)?" current":""}${I(k.currentTrack)===I(m)&&Xt()?" playing":""}${p()<(a()??0)?" past":""}`)),xt(),o})()]}),E,W),c})()}Zt(["click"]);var gi=C('<div class=volume-container><img class=adjust-volume-icon src=/img/audio-white.svg alt="Adjust Volume"><div class=volume-slider-container><div class=volume-slider-inner><div class=volume-slider-background></div><div class=volume-slider></div><div class=volume-slider-top>');let zt,Rt,Nt,Dt,Vt,ft,Qt;function be(e){if(!e)return 0;const i=e.getBoundingClientRect(),a=Math.min(1,Math.max(0,1-(Qt-i.top)/i.height));return Math.min(100,Math.max(0,Math.round(100*a)))}function ke(){let e,i;const[a,v]=g(!1),[L,c]=g(!1),[P,H]=g(100),[V,E]=g(!1),[W,m]=g(!1);function p(o){if(isNaN(o))return;let l=o;o>100?l=100:o<0&&(l=0),k.currentPlaybackSession?.volume!==l/100&&Xe(l/100)}return X(Y(()=>k.currentPlaybackSession?.volume??1,o=>{const l=Math.round(Math.max(0,Math.min(100,o*100)));H(l)})),yt(()=>{function o(){ft=setTimeout(()=>{v(!1),ft=void 0},400)}zt=l=>{c(!0),ft&&(clearTimeout(ft),ft=void 0),v(!0)},Rt=l=>{c(!1),V()||o()},Nt=l=>{l.button===0&&(E(!0),m(!0),Qt=l.clientY,p(be(i)))},Dt=l=>{if(a()){if(Qt=l.clientY,V()){if(l.preventDefault(),!W())return}else return;p(be(i))}},Vt=l=>{if(l.button===0&&V()){if(E(!1),!L()&&a()&&o(),!W())return;m(!1),l.preventDefault()}},e.addEventListener("mouseenter",zt),e.addEventListener("mouseleave",Rt),i.addEventListener("mousedown",Nt),window.addEventListener("mousemove",Dt),window.addEventListener("mouseup",Vt)}),nt(()=>{e.removeEventListener("mouseenter",zt),e.removeEventListener("mouseleave",Rt),i.removeEventListener("mousedown",Nt),window.removeEventListener("mousemove",Dt),window.removeEventListener("mouseup",Vt)}),(()=>{var o=T(gi),l=o.firstChild,h=l.nextSibling,M=h.firstChild,O=M.firstChild,A=O.nextSibling,z=A.nextSibling,R=e;typeof R=="function"?F(R,o):e=o,l.$$click=()=>v(!a());var N=i;return typeof N=="function"?F(N,M):i=M,gt($=>{var w=a()?void 0:"none",_=`${P()}%`,x=`${P()}%`;return w!==$.e&&(($.e=w)!=null?h.style.setProperty("display",w):h.style.removeProperty("display")),_!==$.t&&(($.t=_)!=null?A.style.setProperty("height",_):A.style.removeProperty("height")),x!==$.a&&(($.a=x)!=null?z.style.setProperty("bottom",x):z.style.removeProperty("bottom")),$},{e:void 0,t:void 0,a:void 0}),xt(),o})()}Zt(["click"]);var mi=C('<div class=visualization><div class=visualization-media-controls-seeker-bar><div class="visualization-media-controls-seeker-bar-progress-trigger visualization-media-controls-seeker-bar-visualizer"><canvas class=visualization-canvas width=0 height=30></canvas></div><div class=visualization-media-controls-seeker-bar-progress-tooltip>');const pt=30,ht=2,St=1,Ot=-1;let tt,Te,it=!0,bt=0;function lt(){return k.currentTrack?.duration??Yt()}function fi(e){let i;return function(a){i&&clearTimeout(i),i=setTimeout(e,300,a)}}function jt(e){if(!e)return 0;const i=e.getBoundingClientRect(),a=Math.min(100,Math.max(0,(Te-i.left)/i.width));return lt()*a}function pi(e){const i=Math.round(jt(e.target));Ue(i,!0),it=!0,bt=i}let At,Bt,It,Ft,qt,Ht;function hi(){let e,i,a;const[v,L]=g(!1),[c,P]=g(!1),[H,V]=g($t()),[E,W]=g(Xt()),[m,p]=g([]),[o,l]=g(),[h,M]=g(0);_e(()=>{W(k.currentPlaybackSession?.playing??!1)});function O(){return Math.max(Math.min(H()??0,lt()),0)}function A(){return Math.max(Math.min($t()??0,lt()),0)}function z(){return c()&&v()?O()/lt():A()/lt()}yt(()=>{At=t=>{t.button===0&&(L(!0),P(!0))},Bt=t=>{Te=t.clientX,!(v()&&(t.preventDefault(),!c()))&&V(jt(i))},It=t=>{if(t.button===0&&v()){if(L(!1),!c())return;P(!1),pi(t),t.preventDefault()}},Ft=()=>{document.visibilityState!=="hidden"&&(f=void 0)},qt=fi(async()=>{k.currentTrack&&(await x(k.currentTrack),R())}),i?.addEventListener("mousedown",At),window.addEventListener("mousemove",Bt),window.addEventListener("mouseup",It),document.addEventListener("visibilitychange",Ft),window.addEventListener("resize",qt),Ht=(t,s)=>{if(s){if(!tt)return;R()}},Ye(Ht)}),nt(()=>{i?.removeEventListener("mousedown",At),window.removeEventListener("mousemove",Bt),window.removeEventListener("mouseup",It),document.removeEventListener("visibilitychange",Ft),window.removeEventListener("resize",qt),Ge(Ht)}),X(Y(()=>$t(),t=>{f=document.timeline.currentTime,it&&(t??0)>bt&&(bt===0||(t??0)<=bt+1)&&E()&&(console.debug("playback started"),it=!1,f=void 0,U())}));function R(){if(!tt)throw new Error("No visualizationData set");M(0);const t=window.devicePixelRatio;e.width=window.innerWidth*t,e.height=pt*t;const s=e.getContext("2d");s.scale(t,t),s.fillStyle="white";const n=Math.max(1,tt.length/window.innerWidth*2),u=[];for(let b=0;b<tt.length&&u.length<window.innerWidth;b+=n)u.push(tt[~~b]);p(u);const r=z();s.fillStyle="white",_(0,m().length),N(r),w(r)}function N(t){const s=e.getContext("2d"),n=h(),u=m(),r=~~(t*u.length);n>r&&(s.fillStyle="white",_(r+1,n)),s.fillStyle="#222222",_(Math.max(0,n-1),r+1),M(r)}function $(t){e.getContext("2d").clearRect(0,0,e.width,e.height),w(t)}function w(t){const s=e.getContext("2d"),n=window.devicePixelRatio,u=o();if(typeof u=="number"){const r=u,b=u,J=~~(r*e.width/n)-1,K=Math.ceil(b*e.width/n)+3;s.clearRect(J,0,K-J,e.height);const D=m(),j=~~(r*D.length)-2,B=Math.ceil(b*D.length)+2;N(t);const rt=h();s.fillStyle="white",_(Math.max(rt+1,j),B)}else N(t);s.fillStyle="white",s.fillRect(e.width*t/n+Ot,0,2,pt),l(t)}function _(t,s){if(t>=s)return;const n=e.getContext("2d"),u=m();n.clearRect(t*(St+ht)-.5+Ot,0,(s-t)*(St+ht)-.5,pt);for(let r=t;r<s;r++){const b=u[r];n.fillRect(r*(St+ht)+Ot,pt/2-b/2,ht/2,b)}}async function x(t){const s=window.innerWidth/(St+ht),n=await ni.getTrackVisualization(t,t.type,s);n.forEach((u,r)=>{n[r]=Math.max(3,Math.round(u/255*pt))}),tt=n}X(Y(()=>k.currentTrack,async(t,s)=>{if(s&&t&&I(s)===I(t))return;tt=void 0,p([]);const n=z();$(n),it=!0,bt=0,t&&(await x(t),R())})),X(Y(()=>Yt(),()=>{V(jt(i)),Q()})),X(Y(()=>E(),t=>{t||(it=!0),v()&&P(!1)}));let at,ot;nt(()=>{Se(at),Pe(ot)}),g("NONE"),yt(()=>{}),nt(()=>{});let f;function G(t){f||(f=t);const s=t-f,n=lt();if(typeof $t()<"u"&&typeof n<"u"){const u=s/1e3*(1/n);Q(u)}if(!E()||it){f=void 0,console.debug("Stopping animation");return}window.requestAnimationFrame(G)}function U(){window.requestAnimationFrame(t=>{f=t,window.requestAnimationFrame(G)})}function Q(t=0){if(it)return;const s=z()+t;w(s)}return(()=>{var t=T(mi),s=t.firstChild,n=s.firstChild,u=n.firstChild,r=n.nextSibling,b=a;typeof b=="function"?F(b,t):a=t;var J=i;typeof J=="function"?F(J,n):i=n,n.style.setProperty("top","-13px"),n.style.setProperty("height","30px");var K=e;return typeof K=="function"?F(K,u):e=u,u.style.setProperty("height","30px"),y(r,()=>Wt(Math.round(O()))),gt(D=>{var j=`max(30px, min(100vw - 40px, ${O()/lt()*100}%))`,B=c()&&v()?"block":void 0;return j!==D.e&&((D.e=j)!=null?r.style.setProperty("left",j):r.style.removeProperty("left")),B!==D.t&&((D.t=B)!=null?r.style.setProperty("display",B):r.style.removeProperty("display")),D},{e:void 0,t:void 0}),t})()}var $i=C('<div class=player><!$><!/><div class=player-controls><div class=player-now-playing><div class=player-album-details></div></div><div class=player-media-controls><div class=player-media-controls-track><button class="media-button button"><img class=previous-track-button src=/img/next-button-white.svg alt="Previous Track"></button><button class="media-button button"><img class=pause-button src=/img/pause-button-white.svg alt=Pause></button><button class="media-button button"><img class=play-button src=/img/play-button-white.svg alt=Play></button><button class="media-button button"><img class=next-track-button src=/img/next-button-white.svg alt="Next Track"></button><img class=show-playback-quality-icon src=/img/more-options-white.svg alt="Show Playback Quality"></div><div class=player-media-controls-seeker><span class=player-media-controls-seeker-current-time></span>//<span class=player-media-controls-seeker-total-time></span></div></div><div class=player-track-options><div class=player-track-options-buttons><!$><!/><img class=show-audio-zones-icon src=/img/speaker-white.svg alt="Configure Audio Outputs"><img class=show-playback-sessions-icon src=/img/speaker-white.svg alt="Show Playback Sessions"><img class=show-playlist-icon src=/img/playlist-white.svg alt="Show Playlist"></div><div class=player-track-options-mobile><img class=mobile-playback-options src=/img/more-options-white.svg alt="Show Playback Options"><img class=show-playlist-icon src=/img/playlist-white.svg alt="Show Playlist"></div></div></div><div><!$><!/><img class=show-audio-zones-icon src=/img/speaker-white.svg alt="Configure Audio Outputs"><img class=show-playback-sessions-icon src=/img/speaker-white.svg alt="Show Playback Sessions"><img class=show-playback-quality-icon src=/img/more-options-white.svg alt="Show Playback Quality"></div><div class=playlist-slideout><div class=playlist-slideout-content></div><div class=playlist-slideout-back-to-now-playing-top>Back to now playing</div><div class=playlist-slideout-back-to-now-playing-bottom>Back to now playing'),bi=C("<div class=player-album-details-icon>"),ki=C("<div class=player-now-playing-details><div class=player-now-playing-details-title><a></a></div><div class=player-now-playing-details-artist><a></a></div><div class=player-now-playing-details-album>Playing from: <a>");function wi(){return k.currentTrack?.duration??Yt()}let Pt;function Ci(){let e,i,a,v,L;const[c,P]=g(!1),[H,V]=g(Xt()),[E,W]=g(!1),[m]=Mt(fe),[p]=Mt(pe),[o]=Mt(he);_e(()=>{V(k.currentPlaybackSession?.playing??!1)});function l(){c()&&(P(!1),Pt=setTimeout(()=>{e.style.display="none",Pt=void 0},200))}function h(){c()||(Pt&&clearTimeout(Pt),e.style.display="block",Q(!0),setTimeout(()=>{P(!0)},0))}function M(){c()?l():h()}function O(){W(!E())}function A(){he.set(!o())}function z(){fe.set(!m())}function R(){pe.set(!p())}X(Y(()=>location.pathname,()=>{l()}));const N=t=>{!e?.contains(t.target)&&!L?.contains(t.target)&&l()};yt(()=>{window.addEventListener("click",N)}),nt(()=>{window.removeEventListener("click",N)});let $,w;yt(()=>{ii($=()=>{c()&&Q()}),li(w=()=>{c()&&Q()})}),nt(()=>{Se($),Pe(w)});const[_,x]=g("NONE");let at,ot;const f=()=>{U()&&(U().getBoundingClientRect().top>e.offsetHeight?(clearTimeout(ot),x("BOTTOM"),a.style.opacity="0",v.style.display="block",setTimeout(()=>{v.style.opacity="1"},0)):U().getBoundingClientRect().bottom<0?(clearTimeout(at),x("TOP"),v.style.opacity="0",a.style.display="block",setTimeout(()=>{a.style.opacity="1"},0)):(a.style.opacity="0",v.style.opacity="0",_()==="TOP"?at=setTimeout(()=>{a.style.display="none"},300):_()==="BOTTOM"&&(ot=setTimeout(()=>{v.style.display="none"},300)),x("NONE")))};yt(()=>{i?.addEventListener("scroll",f),f()}),nt(()=>{i?.removeEventListener("scroll",f)});function G(){return e?.querySelector(".playlist-tracks-playing-from")??null}function U(){return e?.querySelector(".playlist-tracks-track.current")??null}function Q(t=!1){G()?.scrollIntoView({behavior:t?"instant":"smooth"})}return(()=>{var t=T($i),s=t.firstChild,[n,u]=st(s.nextSibling),r=n.nextSibling,b=r.firstChild,J=b.firstChild,K=b.nextSibling,D=K.firstChild,j=D.firstChild,B=j.nextSibling,rt=B.nextSibling,Gt=rt.nextSibling,Ce=Gt.nextSibling,Le=D.nextSibling,Ut=Le.firstChild,Ee=Ut.nextSibling,Me=Ee.nextSibling,ze=K.nextSibling,Tt=ze.firstChild,Re=Tt.firstChild,[Jt,Ne]=st(Re.nextSibling),Kt=Jt.nextSibling,te=Kt.nextSibling,De=te.nextSibling,Ve=Tt.nextSibling,ee=Ve.firstChild,Oe=ee.nextSibling,kt=r.nextSibling,Ae=kt.firstChild,[ie,Be]=st(Ae.nextSibling),le=ie.nextSibling,se=le.nextSibling,Ie=se.nextSibling,mt=kt.nextSibling,wt=mt.firstChild,_t=wt.nextSibling,Ct=_t.nextSibling,ne=L;typeof ne=="function"?F(ne,t):L=t,y(t,Z(hi,{}),n,u),y(J,Z(We,{get when(){return k.currentTrack},children:d=>[(()=>{var q=T(bi);return y(q,Z(xe,{get album(){return d()},size:70,artist:!1,title:!1})),q})(),(()=>{var q=T(ki),ct=q.firstChild,ut=ct.firstChild,dt=ct.nextSibling,Lt=dt.firstChild,Fe=dt.nextSibling,qe=Fe.firstChild,Et=qe.nextSibling;return y(ut,()=>d().title),y(Lt,()=>d().artist),y(Et,()=>d().album),gt(S=>{var ue=$e(d()),de=d().title,ve=si(d()),ye=d().artist,ge=$e(d()),me=d().album;return ue!==S.e&&et(ut,"href",S.e=ue),de!==S.t&&et(ut,"title",S.t=de),ve!==S.a&&et(Lt,"href",S.a=ve),ye!==S.o&&et(Lt,"title",S.o=ye),ge!==S.i&&et(Et,"href",S.i=ge),me!==S.n&&et(Et,"title",S.n=me),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),q})()]})),j.$$click=()=>Je(),B.$$click=()=>Ke(),rt.$$click=()=>ti(),Gt.$$click=()=>ei(),Ce.$$click=()=>A(),y(Ut,()=>Wt($t()??0)),y(Me,()=>Wt(wi())),y(Tt,Z(ke,{}),Jt,Ne),Kt.$$click=()=>z(),te.$$click=()=>R(),De.$$click=()=>M(),ee.$$click=()=>O(),Oe.$$click=()=>M(),y(kt,Z(ke,{}),ie,Be),le.$$click=()=>z(),se.$$click=()=>R(),Ie.$$click=()=>A();var ae=e;typeof ae=="function"?F(ae,mt):e=mt;var oe=i;typeof oe=="function"?F(oe,wt):i=wt,y(wt,Z(yi,{})),_t.$$click=()=>Q();var re=a;typeof re=="function"?F(re,_t):a=_t,Ct.$$click=()=>Q();var ce=v;return typeof ce=="function"?F(ce,Ct):v=Ct,gt(d=>{var q=H()?"initial":"none",ct=H()?"none":"initial",ut=`player-track-options-mobile-buttons${E()?" visible":" hidden"}`,dt=`translateX(${c()?0:100}%)`;return q!==d.e&&((d.e=q)!=null?B.style.setProperty("display",q):B.style.removeProperty("display")),ct!==d.t&&((d.t=ct)!=null?rt.style.setProperty("display",ct):rt.style.removeProperty("display")),ut!==d.a&&we(kt,d.a=ut),dt!==d.o&&((d.o=dt)!=null?mt.style.setProperty("transform",dt):mt.style.removeProperty("transform")),d},{e:void 0,t:void 0,a:void 0,o:void 0}),xt(),t})()}Zt(["click"]);export{Ci as default};
//# sourceMappingURL=Player.BFUB-p7N.js.map
